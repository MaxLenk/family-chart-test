{"version":3,"sources":["components/Navbar/NavbarElements.js","components/Navbar/index.js","src/family-chart/d3.js","src/family-chart/CalculateTree/CalculateTree.handlers.js","src/family-chart/handlers/checkIfRelativesConnectedWithoutPerson.js","src/family-chart/handlers/general.js","src/family-chart/handlers/newPerson.js","src/family-chart/CalculateTree/CalculateTree.js","src/family-chart/view/View.handlers.js","src/family-chart/view/elements/Link.js","src/family-chart/view/elements/Card.Elements.js","src/family-chart/handlers/cardMethods.js","src/family-chart/view/elements/Card.js","src/family-chart/AddRelativeTree/AddRelativeTree.CalculateTree.js","src/family-chart/AddRelativeTree/AddRelativeTree.View.js","src/family-chart/AddRelativeTree/AddRelativeTree.AddRelative.js","src/family-chart/AddRelativeTree/AddRelativeTree.js","src/family-chart/index.js","src/family-chart/createStore.js","src/family-chart/view/View.d3Animation.js","src/family-chart/CalculateTree/createLinks.js","src/FamilyChart.js","pages/familyTree.js","pages/pictures.js","pages/picture.js","src/person_utils.js","pages/person.js","App.js","index.js"],"names":["Nav","styled","nav","NavLink","Link","NavMenu","FaBars","div","Navbar","to","activestyle","window","d3","_d3","otherParent","d","p1","data","find","d0","id","rels","mother","father","calculateEnterAndExitPositions","entering","exiting","depth","spouse","_x","x","_y","y","is_ancestry","parent","psx","toggleRels","tree_datum","hide_rels","rels_","showHideAncestry","rel_type","main","children","slice","spouses","forEach","sp","ch_id","includes","push","splice","indexOf","showHideChildren","toggleAllRels","tree_data","checkIfRelativesConnectedWithoutPerson","datum","data_stash","r","r_ids","filter","r_id","rels_not_to_main","i","without_persons","line","isM","checkIfAnyRelIsMain","history","runAllRels","f","d_id","findPersonLineToMain","length","moveToAddToAdded","to_add","removeToAdd","deletePerson","k","hasOwnProperty","Array","isArray","findIndex","did","createTreeDataWithMainNode","success","error","manualZoom","amount","svg","transition_time","zoom","__zoomObj","select","transition","duration","delay","call","scaleBy","isAllRelativeDisplayed","v","every","rel_id","some","generateUUID","Date","getTime","d2","performance","now","replace","c","Math","random","floor","toString","handleRelsOfNewDatum","rel_datum","addSpouse","spouse_id","removeIfToAdd","other_parent","new_spouse","createNewPersonWithGenderFromRel","addNewPerson","addOtherParent","gender","addChildToSpouseAndParentToChild","addChild","is_father","parent_to_add_id","handleSpouse","addParent","createNewPerson","getGenderFromRelative","Object","assign","version","addNewPersonAndHandleRels","CalculateTree","main_id","is_vertical","node_separation","level_separation","to_add_spouses","child","d1","createToAddSpouse","createRelsToAdd","sort","a","b","a_d","b_d","a_p2","b_p2","a_i","b_i","tree_children","calculateTreePositions","tree_parents","parents","mid_diff","levelOutEachSide","tree","setupChildrenAndParents","side","sp_id","added","sx","p2","midd","setupSpouses","d_x","nodePositioning","dim","w_extent","extent","h_extent","width","height","x_off","y_off","calculateTreeDim","rt","hierarchyGetter","map","d3_tree","nodeSize","separation","offset","sameParent","hasSpouses","someSpouses","max","offsetOnPartners","sameBothParents","root","hierarchy","descendants","positionTree","t","transform","zoomIdentity","scale","translate","treeFit","svg_dim","tree_dim","with_transition","min","calculateTreeFit","createPath","is_","curve","curveMonotoneY","lineCurve","curveBasis","path_data","_d","CardBody","card_dim","card_display","template","w","h","text_x","text_y","CardBodyAddNew","card_add","label","CardBodyOutline","is_new","PencilIcon","HideIcon","MiniTree","PlusIcon","InfoIcon","LinkBreakIcon","closed","LinkBreakIconWrapper","g","_r","_rels","areParents","areChildren","sp_r","_sp_r","CardImage","image","maleIcon","femaleIcon","img_x","img_y","img_h","img_w","cardChangeMain","store","card","getTree","update","mainId","tree_position","cardEdit","cardEditForm","postSubmit","props","getData","delete","cardShowHideRels","Card","default_props","mini_tree","link_break","setupProps","querySelector","curvedRectPath","no_curve_corners","ncc","ncc_check","corner","lx","rx","ry","ly","insertAdjacentHTML","setupSvgDefs","node","el","document","createElementNS","gender_class","show_mini_tree","state","unknown_lbl","innerHTML","avatar","infoLink","p","addEventListener","e","stopPropagation","addRelative","open","process","setupListeners","labels","lbls","fn","ln","son","daughter","View","cont","getBoundingClientRect","tree_fit","s","is_main","pos","color_class","mounted","view","closest","getAttribute","new_datum","remove","handleCardClick","target","AddRelative","innerWidth","div_add_relative","createElement","style","cssText","appendChild","AddRelativeTree","createStore","initial_state","onUpdate","setOnUpdate","methods","d3AnimationView","svg_html","fake_cont","firstElementChild","createSvg","zoom_polite","__zoom","on","attr","type","ctrlKey","touches","setupZoom","setupSvg","selectAll","card_exit","exit","card_enter","enter","append","card_update","merge","CardElement","CardDefault","each","this","calculateDelay","updateCards","links_data","reduce","acc","concat","links","_or","join","getMid","linkId","handleAncestrySide","handleProgenySide","hy","args","createLinks","link","link_exit","link_enter","link_update","path","updateLinks","initial","mainToMiddle","ancestry_levels","setCard","handlers","elements","FamilyTree","React","createRef","current","f3","treeJsonData","className","ref","Component","Names","row","id_list","original","people","whiteSpace","names","current_row","index","key","filename","current_person","index2","href","Pictures","jsonData","columns","useMemo","Header","accessor","date","year","month","day","Cell","useState","search","setSearch","processedPictureJsonData","pictureJsonData","keys","picture","toLowerCase","useTable","getTableProps","getTableBodyProps","headerGroups","rows","prepareRow","margin","display","htmlFor","onChange","event","value","border","headerGroup","getHeaderGroupProps","headers","column","getHeaderProps","render","getRowProps","cells","cell","getCellProps","formatPictureInformation","information_list","people_string","date_string","location","formatPictureLabels","image_labels_loc","pictureData","fetch","text","label_data_text","label_array","label_centroids_x","label_centroids_y","split","current_label","current_label_info","parseFloat","label_jsx_list","name_row","row_index","cur_label_array","cur_label_centroids_x","cur_label_index","argMin","name","column_index","cur_label","position","background","opacity","color","textDecoration","flexDirection","justifyContent","alignItems","textAlign","left","toFixed","top","onMouseOver","labelMouseOver","onMouseOut","labelMouseOut","pathname","array","Picture","setLabels","useSearchParams","image_name","get","image_loc","picture_data","response","src","alt","information_row","nameFromId","person_id","orderedTreeJsonData","formatPersonInformation","fontStyle","element","relatives_list","output_list","cur_id","parent_link","cur_ids","spouses_list","current_id","personRelativesList","Person","pictures_jsx","pictureJson","getPersonPictures","App","ReactDOM","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.fae424e0.chunk.js","sourcesContent":["import { FaBars } from \"react-icons/fa\";\nimport { NavLink as Link } from \"react-router-dom\";\nimport styled from \"styled-components\";\n  \nexport const Nav = styled.nav`\n  background: #afc2f9;\n  height: 85px;\n  display: flex;\n  justify-content: space-between;\n  z-index: 12;\n`;\n  \nexport const NavLink = styled(Link)`\n  color: #808080;\n  display: flex;\n  align-items: center;\n  text-decoration: none;\n  padding: 0 1rem;\n  height: 100%;\n  cursor: pointer;\n  &.active {\n    color: #000000;\n  }\n  &:hover,\n  &:focus {\n    color: blue;\n  }\n`;\n  \nexport const Bars = styled(FaBars)`\n  display: none;\n  color: #808080;\n  @media screen and (max-width: 768px) {\n    display: block;\n    position: absolute;\n    top: 0;\n    right: 0;\n    transform: translate(-100%, 75%);\n    font-size: 1.8rem;\n    cursor: pointer;\n  }\n`;\n  \nexport const NavMenu = styled.div`\n  display: flex;\n  align-items: center;\n  margin-right: -24px;\n  @media screen and (max-width: 768px) {\n    display: none;\n  }\n`;","import React from \"react\";\nimport { Nav, NavLink, NavMenu } \n    from \"./NavbarElements\";\n  \nconst Navbar = () => {\n  return (\n    <>\n      <Nav>\n        <NavMenu>\n          <NavLink to=\"/family-tree\" activestyle=\"true\">\n            Family Tree\n          </NavLink>\n          <NavLink to=\"/pictures\" activestyle=\"true\">\n            Pictures\n          </NavLink>\n        </NavMenu>\n      </Nav>\n    </>\n  );\n};\n  \nexport default Navbar;","import * as _d3 from 'd3';\nexport default typeof window === \"object\" && !!window.d3 ? window.d3 : _d3;","export function sortChildrenWithSpouses(data) {\n  data.forEach(datum => {\n    if (!datum.rels.children) return\n    datum.rels.children.sort((a, b) => {\n      const a_d = data.find(d => d.id === a),\n        b_d = data.find(d => d.id === b),\n        a_p2 = otherParent(a_d, datum, data) || {},\n        b_p2 = otherParent(b_d, datum, data) || {},\n        a_i = datum.rels.spouses.indexOf(a_p2.id),\n        b_i = datum.rels.spouses.indexOf(b_p2.id)\n\n      if (datum.data.gender === \"M\") return a_i - b_i\n      else return b_i - a_i\n    })\n  })\n}\n\nfunction otherParent(d, p1, data) {\n  return data.find(d0 => (d0.id !== p1.id) && ((d0.id === d.rels.mother) || (d0.id === d.rels.father)))\n}\n\nexport function calculateEnterAndExitPositions(d, entering, exiting) {\n  d.exiting = exiting\n  if (entering) {\n    if (d.depth === 0 && !d.spouse) {d._x = d.x; d._y = d.y}\n    else if (d.spouse) {d._x = d.spouse.x; d._y = d.spouse.y;}\n    else if (d.is_ancestry) {d._x = d.parent.x; d._y = d.parent.y;}\n    else {d._x = d.psx; d._y = d.parent.y;}\n  } else if (exiting) {\n    const x = d.x > 0 ? 1 : -1,\n      y = d.y > 0 ? 1 : -1\n    d._x = d.x+400*x; d._y = d.y+400*y;\n  }\n}\n\nexport function toggleRels(tree_datum, hide_rels) {\n  const\n    rels = hide_rels ? 'rels' : '_rels',\n    rels_ = hide_rels ? '_rels' : 'rels'\n  \n  if (tree_datum.is_ancestry || tree_datum.data.main) {showHideAncestry('father'); showHideAncestry('mother')}\n  else {showHideChildren()}\n\n  function showHideAncestry(rel_type) {\n    if (!tree_datum.data[rels] || !tree_datum.data[rels][rel_type]) return\n    if (!tree_datum.data[rels_]) tree_datum.data[rels_] = {}\n    tree_datum.data[rels_][rel_type] = tree_datum.data[rels][rel_type]\n    delete tree_datum.data[rels][rel_type]\n  }\n\n  function showHideChildren() {\n    if (!tree_datum.data[rels] || !tree_datum.data[rels].children) return\n    const\n      children = tree_datum.data[rels].children.slice(0),\n      spouses = tree_datum.spouse ? [tree_datum.spouse] : tree_datum.spouses || [];\n\n    [tree_datum, ...spouses].forEach(sp => children.forEach(ch_id => {\n      if (sp.data[rels].children.includes(ch_id)) {\n        if (!sp.data[rels_]) sp.data[rels_] = {}\n        if (!sp.data[rels_].children) sp.data[rels_].children = []\n        sp.data[rels_].children.push(ch_id)\n        sp.data[rels].children.splice(sp.data[rels].children.indexOf(ch_id), 1)\n      }\n    }))\n  }\n}\n\nexport function toggleAllRels(tree_data, hide_rels) {\n  tree_data.forEach(d => {d.data.hide_rels = hide_rels; toggleRels(d, hide_rels)})\n}\n\n","export function checkIfRelativesConnectedWithoutPerson(datum, data_stash) {\n  const r = datum.rels,\n    r_ids = [r.father, r.mother, ...(r.spouses || []), ...(r.children || [])].filter(r_id => !!r_id),\n    rels_not_to_main = [];\n\n  for (let i = 0; i < r_ids.length; i++) {\n    const line = findPersonLineToMain(data_stash.find(d => d.id === r_ids[i]), [datum])\n    if (!line) {rels_not_to_main.push(r_ids[i]); break;}\n  }\n  return rels_not_to_main.length === 0;\n\n  function findPersonLineToMain(datum, without_persons) {\n    let line;\n    if (isM(datum)) line = [datum]\n    checkIfAnyRelIsMain(datum, [datum])\n    return line\n\n    function checkIfAnyRelIsMain(d0, history) {\n      if (line) return\n      history = [...history, d0];\n      runAllRels(check);\n      if (!line) runAllRels(checkRels);\n\n      function runAllRels(f) {\n        const r = d0.rels;\n        [r.father, r.mother, ...(r.spouses || []), ...(r.children || [])]\n          .filter(d_id => (d_id && ![...without_persons, ...history].find(d => d.id === d_id)))\n          .forEach(d_id => f(d_id));\n      }\n\n      function check(d_id) {\n        if (isM(d_id)) line = history\n      }\n\n      function checkRels(d_id) {\n        const person = data_stash.find(d => d.id === d_id)\n        checkIfAnyRelIsMain(person, history)\n      }\n    }\n  }\n  function isM(d0) {return typeof d0 === 'object' ? d0.id === data_stash[0].id : d0 === data_stash[0].id}  // todo: make main more exact\n}","import d3 from \"../d3.js\"\nimport {checkIfRelativesConnectedWithoutPerson} from \"./checkIfRelativesConnectedWithoutPerson.js\"\nimport {createTreeDataWithMainNode} from \"./newPerson.js\"\n\nexport function moveToAddToAdded(datum, data_stash) {\n  delete datum.to_add\n  return datum\n}\n\nexport function removeToAdd(datum, data_stash) {\n  deletePerson(datum, data_stash)\n  return false\n}\n\nexport function deletePerson(datum, data_stash) {\n  if (!checkIfRelativesConnectedWithoutPerson(datum, data_stash)) return {success: false, error: 'checkIfRelativesConnectedWithoutPerson'}\n  executeDelete()\n  return {success: true};\n\n  function executeDelete() {\n    data_stash.forEach(d => {\n      for (let k in d.rels) {\n        if (!d.rels.hasOwnProperty(k)) continue\n        if (d.rels[k] === datum.id) {\n          delete d.rels[k]\n        } else if (Array.isArray(d.rels[k]) && d.rels[k].includes(datum.id)) {\n          d.rels[k].splice(d.rels[k].findIndex(did => did === datum.id), 1)\n        }\n      }\n    })\n    data_stash.splice(data_stash.findIndex(d => d.id === datum.id), 1)\n    data_stash.forEach(d => {if (d.to_add) deletePerson(d, data_stash)})  // full update of tree\n    if (data_stash.length === 0) data_stash.push(createTreeDataWithMainNode({}).data[0])\n  }\n}\n\nexport function manualZoom({amount, svg, transition_time=500}) {\n  const zoom = svg.__zoomObj\n  d3.select(svg).transition().duration(transition_time || 0).delay(transition_time ? 100 : 0)  // delay 100 because of weird error of undefined something in d3 zoom\n    .call(zoom.scaleBy, amount)\n}\n\nexport function isAllRelativeDisplayed(d, data) {\n  const r = d.data.rels,\n    all_rels = [r.father, r.mother, ...(r.spouses || []), ...(r.children || [])].filter(v => v)\n  return all_rels.every(rel_id => data.some(d => d.data.id === rel_id))\n}\n\nexport function generateUUID() {\n  var d = new Date().getTime();\n  var d2 = (performance && performance.now && (performance.now()*1000)) || 0;//Time in microseconds since page-load or 0 if unsupported\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    var r = Math.random() * 16;\n    if(d > 0){//Use timestamp until depleted\n      r = (d + r)%16 | 0;\n      d = Math.floor(d/16);\n    } else {//Use microseconds since page-load if supported\n      r = (d2 + r)%16 | 0;\n      d2 = Math.floor(d2/16);\n    }\n    return (c === 'x' ? r : ((r & 0x3) | 0x8)).toString(16);\n  });\n}\n","import {generateUUID, removeToAdd} from \"./general.js\";\n\nexport function handleRelsOfNewDatum({datum, data_stash, rel_type, rel_datum}) {\n  if (rel_type === \"daughter\" || rel_type === \"son\") addChild(datum)\n  else if (rel_type === \"father\" || rel_type === \"mother\") addParent(datum)\n  else if (rel_type === \"spouse\") addSpouse(datum)\n\n  function addChild(datum) {\n    if (datum.data.other_parent) {\n      addChildToSpouseAndParentToChild(datum.data.other_parent)\n      delete datum.data.other_parent\n    }\n    datum.rels[rel_datum.data.gender === 'M' ? 'father' : 'mother'] = rel_datum.id\n    if (!rel_datum.rels.children) rel_datum.rels.children = []\n    rel_datum.rels.children.push(datum.id)\n    return datum\n\n    function addChildToSpouseAndParentToChild(spouse_id) {\n      if (spouse_id === \"_new\") spouse_id = addOtherParent().id;\n\n      const spouse = data_stash.find(d => d.id === spouse_id)\n      datum.rels[spouse.data.gender === 'M' ? 'father' : 'mother'] = spouse.id\n      if (!spouse.rels.hasOwnProperty('children')) spouse.rels.children = []\n      spouse.rels.children.push(datum.id)\n\n      function addOtherParent() {\n        const new_spouse = createNewPersonWithGenderFromRel({rel_type: \"spouse\", rel_datum})\n        addSpouse(new_spouse)\n        addNewPerson({data_stash, datum: new_spouse})\n        return new_spouse\n      }\n    }\n  }\n\n  function addParent(datum) {\n    const is_father = datum.data.gender === \"M\",\n      parent_to_add_id = rel_datum.rels[is_father ? 'father' : 'mother'];\n    if (parent_to_add_id) removeToAdd(data_stash.find(d => d.id === parent_to_add_id), data_stash)\n    addNewParent()\n\n    function addNewParent() {\n      rel_datum.rels[is_father ? 'father' : 'mother'] = datum.id\n      handleSpouse()\n      datum.rels.children = [rel_datum.id]\n      return datum\n\n      function handleSpouse() {\n        const spouse_id = rel_datum.rels[!is_father ? 'father' : 'mother']\n        if (!spouse_id) return\n        const spouse = data_stash.find(d => d.id === spouse_id)\n        datum.rels.spouses = [spouse_id]\n        if (!spouse.rels.spouses) spouse.rels.spouses = []\n        spouse.rels.spouses.push(datum.id)\n        return spouse\n      }\n    }\n  }\n\n  function addSpouse(datum) {\n    removeIfToAdd();\n    if (!rel_datum.rels.spouses) rel_datum.rels.spouses = []\n    rel_datum.rels.spouses.push(datum.id);\n    datum.rels.spouses = [rel_datum.id];\n\n    function removeIfToAdd() {\n      if (!rel_datum.rels.spouses) return\n      rel_datum.rels.spouses.forEach(spouse_id => {\n        const spouse = data_stash.find(d => d.id === spouse_id);\n        if (spouse.to_add) removeToAdd(spouse, data_stash)\n      })\n    }\n  }\n}\n\nexport function createNewPerson({data, rels}) {\n  return {id: generateUUID(), data: data || {}, rels: rels || {}}\n}\n\nexport function createNewPersonWithGenderFromRel({data, rel_type, rel_datum}) {\n  const gender = getGenderFromRelative(rel_datum, rel_type)\n  data = Object.assign(data || {}, {gender})\n  return createNewPerson({data})\n\n  function getGenderFromRelative(rel_datum, rel_type) {\n    return ([\"daughter\", \"mother\"].includes(rel_type) || (rel_type === \"spouse\" && rel_datum.data.gender === \"M\")) ? \"F\" : \"M\"\n  }\n}\n\nexport function addNewPerson({data_stash, datum}) {\n  data_stash.push(datum)\n}\n\nexport function createTreeDataWithMainNode({data, version}) {\n  return {data: [createNewPerson({data})], version}\n}\n\nexport function addNewPersonAndHandleRels({datum, data_stash, rel_type, rel_datum}) {\n  addNewPerson({data_stash, datum})\n  handleRelsOfNewDatum({datum, data_stash, rel_type, rel_datum})\n}\n","import d3 from \"../d3.js\"\nimport {sortChildrenWithSpouses} from \"./CalculateTree.handlers.js\"\nimport {createNewPerson} from \"../handlers/newPerson.js\"\n\nexport default function CalculateTree({data_stash, main_id=null, is_vertical=true, node_separation=250, level_separation=150}) {\n  data_stash = createRelsToAdd(data_stash)\n  sortChildrenWithSpouses(data_stash)\n  const main = main_id !== null ? data_stash.find(d => d.id === main_id) : data_stash[0],\n    tree_children = calculateTreePositions(main, 'children', false),\n    tree_parents = calculateTreePositions(main, 'parents', true)\n\n  data_stash.forEach(d => d.main = d === main)\n  levelOutEachSide(tree_parents, tree_children)\n  const tree = mergeSides(tree_parents, tree_children)\n  setupChildrenAndParents({tree})\n  setupSpouses({tree, node_separation})\n  nodePositioning({tree, is_vertical})\n\n  const dim = calculateTreeDim(tree, node_separation, level_separation, is_vertical)\n\n  return {data: tree, data_stash, dim}\n\n  function calculateTreePositions(datum, rt, is_ancestry) {\n    const hierarchyGetter = rt === \"children\" ? hierarchyGetterChildren : hierarchyGetterParents,\n      d3_tree = d3.tree().nodeSize([node_separation, level_separation]).separation(separation),\n      root = d3.hierarchy(datum, hierarchyGetter);\n    d3_tree(root);\n    return root.descendants()\n\n    function separation(a, b) {\n      let offset = 1;\n      if (!is_ancestry) {\n        if (!sameParent(a, b)) offset+=.25\n        if (someSpouses(a,b)) offset+=offsetOnPartners(a,b)\n        if (sameParent(a, b) && !sameBothParents(a,b)) offset+=.125\n      }\n      return offset\n    }\n\n    //function hasCh(d) {return !!d.children}\n    function sameParent(a, b) {return a.parent === b.parent}\n    function sameBothParents(a, b) {return (a.data.rels.father === b.data.rels.father) && (a.data.rels.mother === b.data.rels.mother)}\n    //function someChildren(a, b) {return hasCh(a) || hasCh(b)}\n    function hasSpouses(d) {return d.data.rels.spouses && d.data.rels.spouses.length > 0}\n    function someSpouses(a, b) {return hasSpouses(a) || hasSpouses(b)}\n\n    function hierarchyGetterChildren(d) {\n      return [...(d.rels.children || [])].map(id => data_stash.find(d => d.id === id))\n    }\n\n    function hierarchyGetterParents(d) {\n      return [d.rels.father, d.rels.mother]\n        .filter(d => d).map(id => data_stash.find(d => d.id === id))\n    }\n\n    function offsetOnPartners(a,b) {\n      return (Math.max((a.data.rels.spouses || []).length, (b.data.rels.spouses || []).length))*.5+.5\n    }\n  }\n\n  function levelOutEachSide(parents, children) {\n    const mid_diff = (parents[0].x - children[0].x) / 2\n    parents.forEach(d => d.x-=mid_diff)\n    children.forEach(d => d.x+=mid_diff)\n  }\n\n  function mergeSides(parents, children) {\n    parents.forEach(d => {d.is_ancestry = true})\n    parents.forEach(d => d.depth === 1 ? d.parent = children[0] : null)\n\n    return [...children, ...parents.slice(1)];\n  }\n  function nodePositioning({tree, is_vertical}) {\n    tree.forEach(d => {\n      d.y *= (d.is_ancestry ? -1 : 1)\n      if (!is_vertical) {\n        const d_x = d.x; d.x = d.y; d.y = d_x\n      }\n    })\n  }\n\n  function setupSpouses({tree, node_separation}) {\n    for (let i = tree.length; i--;) {\n      const d = tree[i]\n      if (!d.is_ancestry && d.data.rels.spouses && d.data.rels.spouses.length > 0){\n        const side = d.data.data.gender === \"M\" ? -1 : 1;  // female on right\n        d.x += d.data.rels.spouses.length/2*node_separation*side;\n        d.data.rels.spouses.forEach((sp_id, i) => {\n          const spouse = {data: data_stash.find(d0 => d0.id === sp_id), added: true}\n\n          spouse.x = d.x-(node_separation*(i+1))*side;\n          spouse.y = d.y\n          spouse.sx = i > 0 ? spouse.x : spouse.x + (node_separation/2)*side\n          spouse.depth = d.depth;\n          spouse.spouse = d;\n          if (!d.spouses) d.spouses = []\n          d.spouses.push(spouse)\n          tree.push(spouse)\n\n          tree.forEach(d0 => (\n            (d0.data.rels.father === d.data.id && d0.data.rels.mother === spouse.data.id) ||\n            (d0.data.rels.mother === d.data.id && d0.data.rels.father === spouse.data.id)\n            ) ? d0.psx = spouse.sx : null\n          )\n        })\n      }\n      if (d.parents && d.parents.length === 2) {\n        const p1 = d.parents[0],\n          p2 = d.parents[1],\n          midd = p1.x - (p1.x - p2.x)/2,\n          x = (d,sp) => midd + (node_separation/2)*(d.x < sp.x ? 1 : -1)\n\n        p2.x = x(p1, p2); p1.x = x(p2, p1)\n      }\n    }\n  }\n\n  function setupChildrenAndParents({tree}) {\n    tree.forEach(d0 => {\n      delete d0.children\n      tree.forEach(d1 => {\n        if (d1.parent === d0) {\n          if (d1.is_ancestry) {\n            if (!d0.parents) d0.parents = []\n            d0.parents.push(d1)\n          } else {\n            if (!d0.children) d0.children = []\n            d0.children.push(d1)\n          }\n        }\n      })\n    })\n  }\n\n  function calculateTreeDim(tree, node_separation, level_separation, is_vertical) {\n    if (!is_vertical) [node_separation, level_separation] = [level_separation, node_separation]\n    const w_extent = d3.extent(tree, d => d.x),\n      h_extent = d3.extent(tree, d => d.y)\n    return {\n      width: w_extent[1] - w_extent[0]+node_separation, height: h_extent[1] - h_extent[0]+level_separation, x_off: -w_extent[0]+node_separation/2, y_off: -h_extent[0]+level_separation/2\n    }\n  }\n\n  function createRelsToAdd(data) {\n    const to_add_spouses = [];\n    for (let i = 0; i < data.length; i++) {\n      const d = data[i];\n      if (d.rels.children && d.rels.children.length > 0) {\n        if (!d.rels.spouses) d.rels.spouses = []\n        const is_father = d.data.gender === \"M\"\n        let spouse\n\n        d.rels.children.forEach(d0 => {\n          const child = data.find(d1 => d1.id === d0)\n          if (child.rels[is_father ? 'father' : 'mother'] !== d.id) return\n          if (child.rels[!is_father ? 'father' : 'mother']) return\n          if (!spouse) {\n            spouse = createToAddSpouse(d)\n            d.rels.spouses.push(spouse.id)\n          }\n          spouse.rels.children.push(child.id)\n          child.rels[!is_father ? 'father' : 'mother'] = spouse.id\n        })\n      }\n    }\n    to_add_spouses.forEach(d => data.push(d))\n    return data\n\n    function createToAddSpouse(d) {\n      const spouse = createNewPerson({\n        data: {gender: d.data.gender === \"M\" ? \"F\" : \"M\"},\n        rels: {spouses: [d.id], children: []}\n      });\n      spouse.to_add = true;\n      to_add_spouses.push(spouse);\n      return spouse\n    }\n  }\n\n}\n","import d3 from \"../d3.js\"\n\nexport function setupSvg(svg, zoom_polite) {\n  setupZoom()\n\n  function setupZoom() {\n    if (svg.__zoom) return\n    const view = svg.querySelector('.view'),\n      zoom = d3.zoom().on(\"zoom\", zoomed)\n\n    d3.select(svg).call(zoom)\n    svg.__zoomObj = zoom\n\n    if (zoom_polite) zoom.filter(zoomFilter)\n\n    function zoomed(e) {\n      d3.select(view).attr(\"transform\", e.transform);\n    }\n\n    function zoomFilter(e) {\n      if (e.type === \"wheel\" && !e.ctrlKey) return false\n      else if (e.touches && e.touches.length < 2) return false\n      else return true\n    }\n  }\n}\n\nfunction positionTree({t, svg, transition_time=2000}) {\n  const zoom = svg.__zoomObj\n\n  // d3.select(svg).call(zoom.transform, d3.zoomIdentity.translate(x*k, y*k))\n\n  d3.select(svg).transition().duration(transition_time || 0).delay(transition_time ? 100 : 0)  // delay 100 because of weird error of undefined something in d3 zoom\n    .call(zoom.transform, d3.zoomIdentity.scale(t.k).translate(t.x, t.y))\n}\n\nexport function treeFit({svg, svg_dim, tree_dim, with_transition, transition_time}) {\n  const t = calculateTreeFit(svg_dim, tree_dim);\n  positionTree({t, svg, with_transition, transition_time})\n}\n\nexport function calculateTreeFit(svg_dim, tree_dim) {\n  let k = Math.min(svg_dim.width / tree_dim.width, svg_dim.height / tree_dim.height),\n    x = tree_dim.x_off + (svg_dim.width - tree_dim.width*k)/k/2,\n    y = tree_dim.y_off + (svg_dim.height - tree_dim.height*k)/k/2\n\n  if (k>1) {x*=k;y*=k;k=1;}\n  return {k,x,y}\n}\n\nexport function mainToMiddle({datum, svg, svg_dim, scale, transition_time}) {\n  const k = scale || 1, x = svg_dim.width/2-datum.x*k, y = svg_dim.height/2-datum.y,\n    t = {k, x: x/k, y: y/k}\n  positionTree({t, svg, with_transition: true, transition_time})\n}\n","import d3 from \"../../d3.js\";\n\nexport default function Link({d, entering, exiting}) {\n  const path = createPath(d, entering, exiting);\n\n  return {template: (`\n    <path d=\"${path}\" fill=\"none\" stroke=\"#fff\" />\n  `)}\n}\n\nexport function createPath(d, is_) {\n  const line = d3.line().curve(d3.curveMonotoneY),\n    lineCurve = d3.line().curve(d3.curveBasis),\n    path_data = is_ ? d._d() : d.d\n\n  if (!d.curve) return line(path_data)\n  else if (d.curve === true) return lineCurve(path_data)\n}","export function CardBody({d,card_dim,card_display}) {\n  return {template: (`\n    <g class=\"card-body\">\n      <rect width=\"${card_dim.w}\" height=\"${card_dim.h}\" class=\"card-body-rect\" />\n      <g transform=\"translate(${card_dim.text_x}, ${card_dim.text_y})\">\n        <text clip-path=\"url(#card_text_clip)\">\n          <tspan x=\"${0}\" dy=\"${14}\">${card_display[0](d.data)}</tspan>\n          <tspan x=\"${0}\" dy=\"${14}\" font-size=\"14\" font-style = \"italic\">${card_display[1](d.data)}</tspan>\n          <tspan x=\"${0}\" dy=\"${14}\" font-size=\"10\">${card_display[2](d.data)}</tspan>\n        </text>\n        <rect width=\"${card_dim.w-card_dim.text_x-10}\" height=\"${card_dim.h-20}\" style=\"mask: url(#fade)\" class=\"text-overflow-mask\" /> \n      </g>\n    </g>\n  `)\n  }\n}\n\nexport function CardBodyAddNew({d,card_dim,card_add,label}) {\n  return {template: (`\n    <g class=\"card-body ${card_add ? 'card_add' : 'card-unknown'}\">\n      <rect class=\"card-body-rect\" width=\"${card_dim.w}\" height=\"${card_dim.h}\" fill=\"rgb(59, 85, 96)\" />\n      <text transform=\"translate(${card_dim.w/2}, ${card_dim.h/2})\" text-anchor=\"middle\" fill=\"#fff\">\n        <tspan font-size=\"18\" dy=\"${8}\">${label}</tspan>\n      </text>\n    </g>\n  `)\n  }\n}\n\nexport function CardBodyOutline({d,card_dim, is_new}) {\n  return {template: (`\n    <rect width=\"${card_dim.w}\" height=\"${card_dim.h}\" rx=\"4\" ry=\"4\" class=\"card-outline ${(d.data.main && !is_new) ? 'card-main-outline' : ''} ${is_new ? 'card-new-outline' : ''}\" />\n  `)\n  }\n}\n\nexport function PencilIcon({d,card_dim,x,y}) {\n  return ({template: (`\n    <g transform=\"translate(${x || card_dim.w-20},${y || card_dim.h-20})scale(.6)\" style=\"cursor: pointer\" class=\"card_edit pencil_icon\">\n      <circle fill=\"rgba(0,0,0,0)\" r=\"17\" cx=\"8.5\" cy=\"8.5\" />\n      <path fill=\"currentColor\" transform=\"translate(-1.5, -1.5)\"\n         d=\"M19.082,2.123L17.749,0.79c-1.052-1.052-2.766-1.054-3.819,0L1.925,12.794c-0.06,0.06-0.104,0.135-0.127,0.216\n          l-1.778,6.224c-0.05,0.175-0.001,0.363,0.127,0.491c0.095,0.095,0.223,0.146,0.354,0.146c0.046,0,0.092-0.006,0.137-0.02\n          l6.224-1.778c0.082-0.023,0.156-0.066,0.216-0.127L19.082,5.942C20.134,4.89,20.134,3.176,19.082,2.123z M3.076,13.057l9.428-9.428\n          l3.738,3.739l-9.428,9.428L3.076,13.057z M2.566,13.961l3.345,3.344l-4.683,1.339L2.566,13.961z M18.375,5.235L16.95,6.66\n          l-3.738-3.739l1.425-1.425c0.664-0.663,1.741-0.664,2.405,0l1.333,1.333C19.038,3.493,19.038,4.572,18.375,5.235z\"/>\n    </g>\n  `)})\n}\n\nexport function HideIcon({d,card_dim}) {\n  return ({template: (`\n    <g transform=\"translate(${card_dim.w-50},${card_dim.h-20})scale(.035)\" style=\"cursor: pointer\" class=\"card_hide_rels hide_rels_icon\">\n      <circle fill=\"rgba(0,0,0,0)\" r=\"256\" cx=\"256\" cy=\"256\" />\n      <g fill=\"currentColor\">\n        <path d=\"m34,256l26.2,26.2c108,108 283.7,108 391.7,0l26.1-26.2-26.2-26.2c-108-108-283.7-108-391.7,0l-26.1,\n          26.2zm222,126.2c-75.8,0-151.6-28.9-209.3-86.6l-32.9-32.9c-3.7-3.7-3.7-9.7 0-13.5l32.9-32.9c115.4-115.4 303.2-115.4 418.6,\n          0l32.9,32.9c3.7,3.7 3.7,9.7 0,13.5l-32.9,32.9c-57.7,57.7-133.5,86.6-209.3,86.6z\"/>\n        <path d=\"m256,183.5c-40,0-72.5,32.5-72.5,72.5s32.5,72.5 72.5,72.5c40,0 72.5-32.5 72.5-72.5s-32.5-72.5-72.5-72.5zm0,\n          164c-50.5,0-91.5-41.1-91.5-91.5 0-50.5 41.1-91.5 91.5-91.5s91.5,41.1 91.5,91.5c0,50.5-41,91.5-91.5,91.5z\"/>\n      </g>\n    </g>\n  `)})\n}\n\nexport function MiniTree({d,card_dim}) {\n  return ({template: (`\n    <g class=\"card_family_tree\" style=\"cursor: pointer\">\n      <rect x=\"-31\" y=\"-25\" width=\"72\" height=\"15\" fill=\"rgba(0,0,0,0)\"></rect>\n      <g transform=\"translate(${card_dim.w*.8},6)scale(.9)\">\n        <rect x=\"-31\" y=\"-25\" width=\"72\" height=\"15\" fill=\"rgba(0,0,0,0)\"></rect>\n        <line y2=\"-17.5\" stroke=\"#fff\" />\n        <line x1=\"-20\" x2=\"20\" y1=\"-17.5\" y2=\"-17.5\" stroke=\"#fff\" />\n        <rect x=\"-31\" y=\"-25\" width=\"25\" height=\"15\" rx=\"5\" ry=\"5\" class=\"card-male\" />\n        <rect x=\"6\" y=\"-25\" width=\"25\" height=\"15\" rx=\"5\" ry=\"5\" class=\"card-female\" />\n      </g>\n    </g>\n  `)})\n}\n\nexport function PlusIcon({d,card_dim,x,y}) {\n  return ({template: (`\n    <g class=\"card_add_relative\">\n      <g transform=\"translate(${x || card_dim.w/2},${y || card_dim.h})scale(.13)\">\n        <circle r=\"80\" cx=\"40\" cy=\"40\" fill=\"rgba(0,0,0,0)\" />\n        <g transform=\"translate(-10, -8)\">\n          <line\n            x1=\"10\" x2=\"90\" y1=\"50\" y2=\"50\"\n            stroke=\"currentColor\" stroke-width=\"15\" stroke-linecap=\"round\"\n          />\n          <line\n            x1=\"50\" x2=\"50\" y1=\"10\" y2=\"90\"\n            stroke=\"currentColor\" stroke-width=\"15\" stroke-linecap=\"round\"\n          />\n        </g>\n      </g>\n    </g>\n  `)})\n}\n\nexport function InfoIcon({d,card_dim,x,y}) {\n  return ({template: (`\n    <g class=\"card_information\">\n      <g transform=\"translate(${x || card_dim.w/2},${y || card_dim.h})scale(.13)\">\n        <circle r=\"80\" cx=\"40\" cy=\"40\" fill=\"rgba(0,0,0,0)\" />\n        <g transform=\"translate(-10, -8)\">\n          <line\n            x1=\"50\" x2=\"50\" y1=\"30\" y2=\"90\"\n            stroke=\"currentColor\" stroke-width=\"25\"\n          />\n          <line\n            x1=\"50\" x2=\"50\" y1=\"0\" y2=\"5\"\n            stroke=\"currentColor\" stroke-width=\"25\" stroke-linecap=\"round\"\n          />\n        </g>\n      </g>\n    </g>\n  `)})\n}\n\nexport function LinkBreakIcon({x,y,rt,closed}) {\n  return ({template: (`\n    <g style=\"\n          transform: translate(-12.2px, -.5px);\n          cursor: pointer;\n        \" \n        fill=\"currentColor\" class=\"card_break_link${closed ? ' closed' : ''}\"\n      >\n      <g style=\"transform: translate(${x}px,${y}px)scale(.02)rotate(${rt+'deg'})\">\n        <rect width=\"1000\" height=\"700\" y=\"150\" style=\"opacity: 0\" />\n        <g class=\"link_upper\">\n          <g>\n            <path d=\"M616.3,426.4c19,4.5,38.1-7.4,42.6-26.4c4.4-19-7.4-38-26.5-42.5L522.5,332c-18,11.1-53.9,33.4-53.9,33.4l80.4,18.6c-7.8,4.9-19.5,12.1-31.3,19.4L616.3,426.4L616.3,426.4z\"/>\n            <path d=\"M727.4,244.2c-50.2-11.6-100.3,3.3-135.7,35.4c28.6,22.6,64.5,30.2,116.4,51.3l141,32.6c23.9,5.6,56.6,47.2,51.1,71l-4.1,17c-5.6,23.7-47.3,56.4-71.2,51l-143.4-33.2c-66.8-8.6-104.1-16.6-132.9-7.5c17.4,44.9,55.9,80.8,106.5,92.4L800.9,588c81.3,18.8,162.3-31.5,181.2-112.4l4-17c18.8-81.1-31.7-161.8-112.9-180.6L727.4,244.2z\"/>\n          </g>\n        </g>\n        <g class=\"link_lower\">\n          <path d=\"M421.2,384.9l-128,127.6c-13.9,13.8-13.9,36.2,0,50s36.3,13.8,50.2,0.1l136.2-135.8v-36.7l-58.4,58.1V384.9L421.2,384.9z\"/>\n          <path d=\"M204.6,742.8c-17.4,17.3-63.3,17.2-80.6,0.1l-12.3-12.3c-17.3-17.3,0.6-81.2,17.9-98.5l100.2-99.9c12.5-14.9,45.8-40.8,66.1-103.7c-47.7-9.4-98.9,4.2-135.8,40.9L54.2,575c-58.9,58.8-58.9,154,0,212.8L66.6,800c58.9,58.8,154.5,58.8,213.4,0l105.8-105.6c38.4-38.3,51.3-91.9,39.7-141c-44,22.7-89,62.3-116,84.8L204.6,742.8z\"/>\n        </g>\n        <g class=\"link_particles\">\n          <path d=\"M351.9,248.4l-26.5,63.4l80.6,30.1L351.9,248.4z\"/>\n          <path d=\"M529.3,208l-43,26.6l35.4,52.3L529.3,208z\"/>\n          <path d=\"M426.6,158.8l-44-2.9l61.7,134.6L426.6,158.8z\"/>\n        </g>\n      </g>\n    </g>\n  `)})\n}\n\nexport function LinkBreakIconWrapper({d,card_dim}) {\n  let g = \"\",\n    r = d.data.rels, _r = d.data._rels || {},\n    closed = d.data.hide_rels,\n    areParents = r => r.father || r.mother,\n    areChildren = r => r.children && r.children.length > 0\n  if ((d.is_ancestry || d.data.main) && (areParents(r) || areParents(_r))) {g+=LinkBreakIcon({x:card_dim.w/2,y:0, rt: -45, closed}).template}\n  if (!d.is_ancestry && d.added) {\n    const sp = d.spouse, sp_r = sp.data.rels, _sp_r = sp.data._rels || {};\n    if ((areChildren(r) || areChildren(_r)) && (areChildren(sp_r) || areChildren(_sp_r))) {\n      g+=LinkBreakIcon({x:d.sx - d.x + card_dim.w/2 +24.4,y: (d.x !== d.sx ? card_dim.h/2 : card_dim.h)+1, rt: 135, closed}).template\n    }\n  }\n  return g\n}\n\nexport function CardImage({d, image, card_dim, maleIcon, femaleIcon}) {\n  return ({template: (`\n    <g style=\"transform: translate(${card_dim.img_x}px,${card_dim.img_y}px);\" class=\"card_image\" clip-path=\"url(#card_image_clip)\">\n      ${image \n        ? `<image href=\"${image}\" height=\"${card_dim.img_h}\" width=\"${card_dim.img_w}\" preserveAspectRatio=\"xMidYMin slice\" />`\n        : (d.data.data.gender === \"F\" && !!femaleIcon) ? femaleIcon({card_dim}) \n        : (d.data.data.gender === \"M\" && !!maleIcon) ? maleIcon({card_dim}) \n        : GenderlessIcon()\n      }      \n    </g>\n  `)})\n\n  function GenderlessIcon() {\n    return (`\n      <g class=\"genderless-icon\">\n        <rect height=\"${card_dim.img_h}\" width=\"${card_dim.img_w}\" fill=\"rgb(59, 85, 96)\" />\n        <g transform=\"scale(${card_dim.img_w*0.001616})\">\n         <path transform=\"translate(50,40)\" fill=\"lightgrey\" d=\"M256 288c79.5 0 144-64.5 144-144S335.5 0 256 0 112 \n            64.5 112 144s64.5 144 144 144zm128 32h-55.1c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16H128C57.3 320 0 377.3 \n            0 448v16c0 26.5 21.5 48 48 48h416c26.5 0 48-21.5 48-48v-16c0-70.7-57.3-128-128-128z\" />\n        </g>\n      </g>\n    `)\n  }\n}\n","import {toggleAllRels, toggleRels} from \"../CalculateTree/CalculateTree.handlers.js\"\n//import AddRelativeTree from \"../AddRelativeTree/AddRelativeTree.js\"\nimport {deletePerson, moveToAddToAdded} from \"./general.js\"\n\nexport function cardChangeMain(store, {card, d}) {\n  toggleAllRels(store.getTree().data, false)\n  store.update.mainId(d.data.id)\n  store.update.tree({tree_position: 'inherit'})\n  return true\n}\n\nexport function cardEdit(store, {card, d, cardEditForm}) {\n  const datum = d.data,\n    postSubmit = (props) => {\n      if (datum.to_add) moveToAddToAdded(datum, store.getData())\n      if (props && props.delete) {\n        if (datum.main) store.update.mainId(null)\n        deletePerson(datum, store.getData())\n      }\n      store.update.tree()\n    }\n  cardEditForm({datum, postSubmit, store})\n}\n\nexport function cardShowHideRels(store, {card, d}) {\n  d.data.hide_rels = !d.data.hide_rels\n  toggleRels(d, d.data.hide_rels)\n  store.update.tree({tree_position: 'inherit'})\n}","import {\n  CardBody,\n  CardBodyAddNew,\n  CardBodyOutline,\n  CardImage,\n  LinkBreakIconWrapper,\n  MiniTree, PencilIcon,\n  PlusIcon, InfoIcon\n} from \"./Card.Elements.js\"\nimport {cardChangeMain, cardEdit, cardShowHideRels} from \"../../handlers/cardMethods.js\"\nimport {isAllRelativeDisplayed} from \"../../handlers/general.js\"\n\nexport function Card(props) {\n  props = setupProps(props);\n  const store = props.store;\n  setupSvgDefs()\n\n  return function ({node, d}) {\n    const el = document.createElementNS(\"http://www.w3.org/2000/svg\", 'g'),\n      gender_class = d.data.data.gender === 'M' ? 'card-male' : d.data.data.gender === 'F' ? 'card-female' : 'card-genderless',\n      card_dim = props.card_dim,\n      show_mini_tree = !isAllRelativeDisplayed(d, store.state.tree.data),\n      unknown_lbl = props.cardEditForm ? 'ADD' : 'UNKNOWN',\n\n      mini_tree = () => !d.data.to_add && show_mini_tree ? MiniTree({d,card_dim}).template : '',\n      card_body_outline = () => CardBodyOutline({d,card_dim,is_new:d.data.to_add}).template,\n      card_body = () => !d.data.to_add ? CardBody({d,card_dim, card_display: props.card_display}).template : CardBodyAddNew({d,card_dim, card_add: props.cardEditForm, label: unknown_lbl}).template,\n      card_image = () => !d.data.to_add ? CardImage({d, image: d.data.data.avatar || null, card_dim, maleIcon: null, femaleIcon: null}).template : '',\n      edit_icon = () => !d.data.to_add && props.cardEditForm ? PencilIcon({card_dim, x: card_dim.w-46, y: card_dim.h-20}).template : '',\n      add_icon = () => !d.data.to_add && props.cardEditForm ? PlusIcon({card_dim, x: card_dim.w-26, y: card_dim.h-20}).template : '',\n      info_icon = () => !d.data.to_add && props.infoLink ? InfoIcon({card_dim, x: card_dim.w-26, y: card_dim.h-20}).template : '',\n      link_break_icon = () => LinkBreakIconWrapper({d,card_dim})\n\n    el.innerHTML = (`\n      <g class=\"card ${gender_class}\" data-id=\"${d.data.id}\" data-cy=\"card\">\n        <g transform=\"translate(${-card_dim.w / 2}, ${-card_dim.h / 2})\">\n          ${props.mini_tree ? mini_tree() : ''}\n          ${card_body_outline()}\n          <g clip-path=\"url(#card_clip)\">\n            ${card_body()}\n            ${card_image()}\n            ${edit_icon()}\n            ${add_icon()}\n            ${info_icon()}\n          </g>\n          ${props.link_break ? link_break_icon() : ''}\n        </g>\n      </g>\n    `)\n    setupListeners(el, d, store);\n\n    return el\n  }\n\n  function setupListeners(el, d, store) {\n    let p;\n\n    p = el.querySelector(\".card\")\n    if (p) p.addEventListener(\"click\", (e) => {e.stopPropagation();cardChangeMain(store, {card:el, d})})\n\n    p = el.querySelector(\".card_edit\")\n    if (p && props.cardEditForm) p.addEventListener(\"click\", (e) => {e.stopPropagation();cardEdit(store, {card:el, d, cardEditForm: props.cardEditForm})})\n\n    p = el.querySelector(\".card_add\")\n    if (p && props.cardEditForm) p.addEventListener(\"click\", (e) => {e.stopPropagation();cardEdit(store, {card:el, d, cardEditForm: props.cardEditForm})})\n\n    p = el.querySelector(\".card_add_relative\")\n    if (p) p.addEventListener(\"click\", (e) => {e.stopPropagation();props.addRelative({d})})\n\n    p = el.querySelector(\".card_information\")\n    if (p) p.addEventListener(\"click\", (e) => {e.stopPropagation();window.open(process.env.PUBLIC_URL + \"#/person?id=\" + d.data.id, \"_blank\");})\n\n    p = el.querySelector(\".card_family_tree\")\n    if (p) p.addEventListener(\"click\", (e) => {e.stopPropagation();cardChangeMain(store, {card:el, d})})\n\n    p = el.querySelector(\".card_break_link\")\n    if (p) p.addEventListener(\"click\", (e) => {e.stopPropagation();cardShowHideRels(store, {card:el, d})})\n  }\n\n  function setupSvgDefs() {\n    if (props.svg.querySelector(\"defs#f3CardDef\")) return\n    const card_dim = props.card_dim\n    props.svg.insertAdjacentHTML('afterbegin', (`\n      <defs id=\"f3CardDef\">\n        <linearGradient id=\"fadeGrad\">\n          <stop offset=\"0.9\" stop-color=\"white\" stop-opacity=\"0\"/>\n          <stop offset=\".91\" stop-color=\"white\" stop-opacity=\".5\"/>\n          <stop offset=\"1\" stop-color=\"white\" stop-opacity=\"1\"/>\n        </linearGradient>\n        <mask id=\"fade\" maskContentUnits=\"objectBoundingBox\"><rect width=\"1\" height=\"1\" fill=\"url(#fadeGrad)\"/></mask>\n        <clipPath id=\"card_clip\"><path d=\"${curvedRectPath({w:card_dim.w, h:card_dim.h}, 5)}\"></clipPath>\n        <clipPath id=\"card_text_clip\"><rect width=\"${card_dim.w-card_dim.text_x-10}\" height=\"${card_dim.h-10}\"></rect></clipPath>\n        <clipPath id=\"card_image_clip\"><path d=\"M0,0 Q 0,0 0,0 H${card_dim.img_w} V${card_dim.img_h} H0 Q 0,${card_dim.img_h} 0,${card_dim.img_h} z\"></clipPath>\n        <clipPath id=\"card_image_clip_curved\"><path d=\"${curvedRectPath({w: card_dim.img_w, h:card_dim.img_h}, 5, ['rx', 'ry'])}\"></clipPath>\n      </defs>\n    `))\n\n    function curvedRectPath(dim, curve, no_curve_corners) {\n      const {w,h} = dim,\n        c = curve,\n        ncc = no_curve_corners || [],\n        ncc_check = (corner) => ncc.includes(corner),\n        lx = ncc_check('lx') ? `M0,0` : `M0,${c} Q 0,0 5,0`,\n        rx = ncc_check('rx') ? `H${w}` : `H${w-c} Q ${w},0 ${w},5`,\n        ry = ncc_check('ry') ? `V${h}` : `V${h-c} Q ${w},${h} ${w-c},${h}`,\n        ly = ncc_check('ly') ? `H0` : `H${c} Q 0,${h} 0,${h-c}`\n\n      return (`${lx} ${rx} ${ry} ${ly} z`)\n    }\n  }\n\n  function setupProps(props) {\n    const default_props = {\n      mini_tree: true,\n      link_break: true,\n      card_dim: {w:220,h:70,text_x:75,text_y:15,img_w:60,img_h:60,img_x:5,img_y:5}\n    }\n    if (!props) props = {}\n    for (const k in default_props) {\n      if (typeof props[k] === 'undefined') props[k] = default_props[k]\n    }\n    return props\n  }\n}\n","export default function CalculateTree({datum, data_stash, card_dim, labels}) {\n  const sx = card_dim.w+40, y = card_dim.h+50,\n    lbls = labels || {}\n  datum = datum ? datum : {id: \"0\", data: {fn: \"FN\", ln: \"LN\", gender: \"M\"}}\n  const data = [\n    {x: 0, y: 0, data: datum},\n    {x: -100, y: -y, data: {rel_type: 'father', data: {label: lbls.father || \"Add father\", gender: \"M\"}}},\n    {x: 100, y: -y, data: {rel_type: 'mother', data: {label: lbls.mother || \"Add mother\", gender: \"F\"}}},\n\n    {x: sx, y: 0, data: {rel_type: 'spouse', data: {label: lbls.spouse || \"Add spouse\", gender: \"F\"}}},\n\n    {x: -100, y: y, data: {rel_type: 'son', data: {label: lbls.son || \"Add son\", gender: \"M\"}}},\n    {x: 100, y: y, data: {rel_type: 'daughter', data: {label: lbls.daughter || \"Add daughter\", gender: \"F\"}}},\n  ].filter(d => shouldAddRel(d.data.rel_type))\n\n  function shouldAddRel(rel_type) {\n    if (rel_type === 'father') return !datum.rels.father || data_stash.find(d => d.id === datum.rels.father).to_add\n    else if (rel_type === 'mother') return !datum.rels.mother || data_stash.find(d => d.id === datum.rels.mother).to_add\n    else return true\n  }\n\n  return {data}\n}\n","import {\n  addNewPerson,\n  createNewPersonWithGenderFromRel,\n  handleRelsOfNewDatum,\n} from \"../handlers/newPerson.js\"\n\nexport default function View(tree, {store, data_stash, cont, datum, card_dim, cardEditForm, scale}) {\n  const svg_dim = cont.getBoundingClientRect(),\n    tree_fit = calculateTreeFit(svg_dim),\n    mounted = (node) => {\n      addEventListeners(node)\n    }\n\n  return {\n    template: (`\n      <svg id=\"family-tree-svg\" style=\"width: 100%; height: 100%\">\n        <rect width=\"${svg_dim.width}\" height=\"${svg_dim.height}\" fill=\"transparent\" />\n        <g class=\"view\">\n          <g transform=\"translate(${tree_fit.x}, ${tree_fit.y})scale(${tree_fit.k})\">\n            ${tree.data.slice(1).map((d, i) => Link({d, is_vertical: ![\"spouse\"].includes(d.data.rel_type)}).template)}\n            ${tree.data.slice(1).map((d, i) => Card({d}).template)}\n          </g>\n        </g>\n      </svg>\n    `),\n    mounted\n  }\n\n  function calculateTreeFit(svg_dim) {\n    const k = scale || 1;\n    return {k, x:svg_dim.width/2, y: svg_dim.height/2}\n  }\n\n  function Card({d, is_main}) {\n    const [w, h] = is_main ? [160, 60] : [160, 40],\n      pos = {x: d.x, y: d.y}\n\n    return {template: (`\n      <g transform=\"translate(${pos.x}, ${pos.y})\" class=\"card\" data-rel_type=\"${d.data.rel_type}\" style=\"cursor: pointer\">\n        <g transform=\"translate(${-w / 2}, ${-h / 2})\">\n          ${CardBody({d,w,h}).template}\n        </g>\n      </g>\n    `)\n    }\n\n    function CardBody({d,w,h}) {\n      const color_class = d.data.data.gender === 'M' ? 'card-male' : d.data.data.gender === 'F' ? 'card-female' : 'card-genderless'\n      return {template: (`\n        <g>\n          <rect width=\"${w}\" height=\"${h}\" fill=\"#fff\" rx=\"${10}\" ${d.data.main ? 'stroke=\"#000\"' : ''} class=\"${color_class}\" />\n          <text transform=\"translate(${0}, ${h / 4})\">\n            <tspan x=\"${10}\" dy=\"${14}\">${d.data.data.label}</tspan>\n          </text>\n        </g>\n      `)\n      }\n    }\n  }\n\n  function Link({d, is_vertical}) {\n    return {template: (`\n      <path d=\"${createPath(d)}\" fill=\"none\" stroke=\"#fff\" />\n    `)}\n\n    function createPath() {\n      const {w,h} = card_dim;\n      let parent = (is_vertical && d.y < 0)\n        ? {x: 0, y: -h/2}\n        : (is_vertical && d.y > 0)\n        ? {x: 0, y: h/2}\n        : (!is_vertical && d.x < 0)\n        ? {x: -w/2, y: 0}\n        : (!is_vertical && d.x > 0)\n        ? {x: w/2, y: 0}\n        : {x: 0, y: 0}\n\n\n      if (is_vertical) {\n        return (\n          \"M\" + d.x + \",\" + d.y\n          + \"C\" + (d.x) + \",\" + (d.y + (d.y < 0 ? 50 : -50))\n          + \" \" + (parent.x) + \",\" + (parent.y + (d.y < 0 ? -50 : 50))\n          + \" \" + parent.x + \",\" + parent.y\n        )\n      } else {\n        const s = d.x > 0 ? +1 : -1;\n        return (\n          \"M\" + d.x + \",\" + d.y\n          + \"C\" + (parent.x + 50*s) + \",\" + d.y\n          + \" \" + (parent.x + 150*s) + \",\" + parent.y\n          + \" \" + parent.x + \",\" + parent.y\n        )\n      }\n    }\n  }\n\n  function addEventListeners(view) {\n    view.addEventListener(\"click\", e => {\n      const node = e.target\n      handleCardClick(node) || view.remove()\n    })\n\n    function handleCardClick(node) {\n      if (!node.closest('.card')) return\n      const card = node.closest('.card'),\n        rel_type = card.getAttribute(\"data-rel_type\"),\n        rel_datum = datum,\n        new_datum = createNewPersonWithGenderFromRel({rel_datum, rel_type}),\n        postSubmit = () => {\n          view.remove();\n          addNewPerson({data_stash, datum: new_datum})\n          handleRelsOfNewDatum({datum: new_datum, data_stash, rel_datum, rel_type})\n          store.update.tree();\n        }\n      cardEditForm({datum: new_datum, rel_datum, rel_type, postSubmit, store})\n      return true\n    }\n  }\n\n}\n","import {toggleAllRels} from \"../CalculateTree/CalculateTree.handlers.js\"\nimport AddRelativeTree from \"./AddRelativeTree.js\"\n\nexport function AddRelative({store, cont, card_dim, cardEditForm, labels}) {\n  return function ({d, scale}) {\n    const transition_time = 1000\n\n    if (!scale && window.innerWidth < 650) scale = window.innerWidth / 650\n    toggleAllRels(store.getTree().data, false)\n    store.update.mainId(d.data.id);\n    store.update.tree({tree_position: 'main_to_middle', transition_time, scale})\n    const props = {\n      store,\n      data_stash: store.getData(),\n      cont,\n      datum: d.data,\n      transition_time,\n      scale,\n      card_dim,\n      cardEditForm,\n      labels\n    }\n    AddRelativeTree(props)\n  }\n}\n","import d3 from \"../d3.js\"\nimport CalculateTree from \"./AddRelativeTree.CalculateTree.js\"\nimport View from \"./AddRelativeTree.View.js\"\n\nexport default function AddRelativeTree(props) {\n  const tree = CalculateTree(props),\n    view = View(tree, props)\n\n  const div_add_relative = document.createElement(\"div\")\n  div_add_relative.style.cssText = \"width: 100%; height: 100%; position: absolute; top: 0; left: 0;background-color: rgba(0,0,0,.3);opacity: 0\"\n  div_add_relative.innerHTML = view.template\n\n  props.cont.appendChild(div_add_relative)\n  view.mounted(div_add_relative)\n  d3.select(div_add_relative).transition().duration(props.transition_time).delay(props.transition_time/4).style(\"opacity\", 1)\n}\n","import CalculateTree from \"./CalculateTree/CalculateTree.js\"\nimport d3AnimationView from \"./view/View.d3Animation.js\"\nimport createStore from \"./createStore.js\"\nimport * as handlers from './handlers.js'\nimport * as elements from './elements.js'\n\nexport default {\n  CalculateTree,\n  createStore,\n  d3AnimationView,\n  handlers,\n  elements\n}","import CalculateTree from \"./CalculateTree/CalculateTree.js\"\n//import {createTreeDataWithMainNode} from \"./handlers/newPerson.js\"\n\nexport default function createStore(initial_state) {\n  let onUpdate;\n  const state = initial_state,\n    update = {\n      tree: (props) => {\n        state.tree = calcTree();\n        if (onUpdate) onUpdate(props)\n      },\n      mainId: main_id => state.main_id = main_id,\n      data: data => state.data = data\n    },\n    getData = () => state.data,\n    getTree = () => state.tree,\n    setOnUpdate = (f) => onUpdate = f,\n    methods = {}\n\n  return {state, update, getData, getTree, setOnUpdate, methods}\n\n\n  function calcTree() {\n    return CalculateTree({\n      data_stash: state.data, main_id: state.main_id,\n      node_separation: state.node_separation, level_separation: state.level_separation\n    })\n  }\n}","import d3 from \"../d3.js\"\n\nimport {mainToMiddle, setupSvg, treeFit} from \"./View.handlers.js\"\nimport {createPath} from \"./elements/Link.js\"\nimport {createLinks} from \"../CalculateTree/createLinks.js\"\nimport {Card as CardDefault} from \"./elements/Card.js\"\nimport {calculateEnterAndExitPositions} from \"../CalculateTree/CalculateTree.handlers.js\"\n\nexport default function d3AnimationView({store, cont, Card}) {\n  const svg = createSvg();\n  setupSvg(svg, store.state.zoom_polite);\n\n  return {update: updateView, svg, setCard: card => Card = card}\n\n  function updateView(props) {\n    if (!props) props = {}\n    const tree = store.state.tree,\n      view = d3.select(svg).select(\".view\"),\n      tree_position = props.tree_position || 'fit',\n      transition_time = props.hasOwnProperty('transition_time') ? props.transition_time : 1000;\n\n    updateCards();\n    updateLinks();\n    if (props.initial) treeFit({svg, svg_dim: svg.getBoundingClientRect(), tree_dim: tree.dim, transition_time: 0})\n    else if (tree_position === 'fit') treeFit({svg, svg_dim: svg.getBoundingClientRect(), tree_dim: tree.dim, transition_time})\n    else if (tree_position === 'main_to_middle') mainToMiddle({datum: tree.data[0], svg, svg_dim: svg.getBoundingClientRect(), scale: props.scale, transition_time})\n    else if (tree_position === 'inherit') {}\n\n    return true\n\n    function updateLinks() {\n      const links_data = tree.data.reduce((acc, d) => acc.concat(createLinks({d, tree:tree.data})), []),\n        link = view.select(\".links_view\").selectAll(\"path.link\").data(links_data, d => d.id),\n        link_exit = link.exit(),\n        link_enter = link.enter().append(\"path\").attr(\"class\", \"link\"),\n        link_update = link_enter.merge(link)\n\n      link_exit.each(linkExit)\n      link_enter.each(linkEnter)\n      link_update.each(linkUpdate)\n\n      function linkEnter(d) {\n        d3.select(this).attr(\"fill\", \"none\").attr(\"stroke\", \"#fff\").style(\"opacity\", 0)\n          .attr(\"d\", createPath(d, true))\n      }\n\n      function linkUpdate(d) {\n        const path = d3.select(this);\n        const delay = calculateDelay(d)\n        path.transition('path').duration(transition_time).delay(delay).attr(\"d\", createPath(d)).style(\"opacity\", 1)\n      }\n\n      function linkExit(d) {\n        const path = d3.select(this);\n        path.transition('op').duration(800).style(\"opacity\", 0)\n        path.transition('path').duration(transition_time).attr(\"d\", createPath(d, true))\n          .on(\"end\", () => path.remove())\n      }\n\n    }\n\n    function updateCards() {\n      const card = view.select(\".cards_view\").selectAll(\"g.card_cont\").data(tree.data, d => d.data.id),\n        card_exit = card.exit(),\n        card_enter = card.enter().append(\"g\").attr(\"class\", \"card_cont\"),\n        card_update = card_enter.merge(card)\n\n      card_exit.each(d => calculateEnterAndExitPositions(d, false, true))\n      card_enter.each(d => calculateEnterAndExitPositions(d, true, false))\n\n      card_exit.each(cardExit)\n      card.each(cardUpdateNoEnter)\n      card_enter.each(cardEnter)\n      card_update.each(cardUpdate)\n\n      function cardEnter(d) {\n        d3.select(this)\n          .attr(\"transform\", `translate(${d._x}, ${d._y})`)\n          .style(\"opacity\", 0)\n          .node().appendChild(CardElement(this, d))\n      }\n\n      function cardUpdateNoEnter(d) {}\n\n      function cardUpdate(d) {\n        this.innerHTML = \"\"\n        this.appendChild(CardElement(this, d))\n        const delay = calculateDelay(d);\n        d3.select(this).transition().duration(transition_time).delay(delay).attr(\"transform\", `translate(${d.x}, ${d.y})`).style(\"opacity\", 1)\n      }\n\n      function cardExit(d) {\n        const g = d3.select(this)\n        g.transition().duration(transition_time).style(\"opacity\", 0).attr(\"transform\", `translate(${d._x}, ${d._y})`)\n          .on(\"end\", () => g.remove())\n      }\n\n      function CardElement(node, d) {\n        if (Card) return Card({node, d})\n        else return CardDefault({store, svg})({node, d})\n      }\n    }\n\n    function calculateDelay(d) {\n      if (!props.initial) return 0\n      const delay_level = 100,\n        ancestry_levels = Math.max(...tree.data.map(d=>d.is_ancestry ? d.depth : 0))\n      let delay = d.depth*delay_level;\n      if ((d.depth !== 0 || !!d.spouse) && !d.is_ancestry) {\n        delay+=(ancestry_levels)*delay_level  // after ancestry\n        if (d.spouse) delay+=delay_level  // spouse after bloodline\n        delay+=(d.depth)*delay_level  // double the delay for each level because of additional spouse delay\n      }\n      return delay\n    }\n\n  }\n\n  function createSvg() {\n    const svg_dim = cont.getBoundingClientRect(),\n      svg_html = (`\n        <svg class=\"main_svg\">\n          <rect width=\"${svg_dim.width}\" height=\"${svg_dim.height}\" fill=\"transparent\" />\n          <g class=\"view\">\n            <g class=\"links_view\"></g>\n            <g class=\"cards_view\"></g>\n          </g>\n          <g style=\"transform: translate(100%, 100%)\">\n            <g class=\"fit_screen_icon cursor-pointer\" style=\"transform: translate(-50px, -50px); display: none\">\n              <rect width=\"27\" height=\"27\" stroke-dasharray=\"${27/2}\" stroke-dashoffset=\"${27/4}\" \n                style=\"stroke:#fff;stroke-width:4px;fill:transparent;\"/>\n              <circle r=\"5\" cx=\"${27/2}\" cy=\"${27/2}\" style=\"fill:#fff\" />          \n            </g>\n          </g>\n        </svg>\n      `)\n    const fake_cont = document.createElement(\"div\")\n    fake_cont.innerHTML = svg_html\n    const svg = fake_cont.firstElementChild\n    cont.innerHTML = \"\"\n    cont.appendChild(svg)\n\n    return svg\n  }\n}","export function createLinks({d, tree, is_vertical}) {\n  const links = [];\n\n  if (d.data.rels.spouses && d.data.rels.spouses.length > 0) handleSpouse({d})\n  handleAncestrySide({d})\n  handleProgenySide({d})\n\n  return links;\n\n  function handleAncestrySide({d}) {\n    if (!d.parents || d.parents.length !== 2) return\n    const p1 = d.parents[0], p2 = d.parents[1]\n\n    const p = {x: getMid(p1, p2, 'x'), y: getMid(p1, p2, 'y')}\n\n    links.push({\n      d: Link(d, p),\n      _d: () => {\n        const _d = {x: d.x, y: d.y},\n          _p = {x: d.x, y: d.y}\n        return Link(_d, _p)\n      },\n      curve: true, id: linkId(d, d.parents[0], d.parents[1]), depth: d.depth+1, is_ancestry: true\n    })\n  }\n\n\n  function handleProgenySide({d}) {\n    if (!d.children || d.children.length === 0) return\n\n    d.children.forEach((child, i) => {\n      const other_parent = otherParent(child, d, tree),\n        sx = other_parent.sx\n\n      links.push({\n        d: Link(child, {x: sx, y: d.y}),\n        _d: () => Link({x: sx, y: d.y}, {x: _or(child, 'x'), y: _or(child, 'y')}),\n        curve: true, id: linkId(child, d, other_parent), depth: d.depth+1\n      })\n    })\n  }\n\n\n  function handleSpouse({d}) {\n    d.data.rels.spouses.forEach(sp_id => {\n      const spouse = tree.find(d0 => d0.data.id === sp_id);\n      if (!spouse || d.spouse) return\n      links.push({\n        d: [[d.x, d.y], [spouse.x, spouse.y]],\n        _d: () => [\n          d.is_ancestry ? [_or(d, 'x')-.0001, _or(d, 'y')] : [d.x, d.y], // add -.0001 to line to have some length if d.x === spouse.x\n          d.is_ancestry ? [_or(spouse, 'x', true), _or(spouse, 'y')] : [d.x-.0001, d.y]\n        ],\n        curve: false, id: [d.data.id, spouse.data.id].join(\", \"), depth: d.depth, spouse: true, is_ancestry: spouse.is_ancestry\n      })\n    })\n  }\n\n  ///\n  function getMid(d1, d2, side, is_) {\n    if (is_) return _or(d1, side) - (_or(d1, side) - _or(d2, side))/2\n    else return d1[side] - (d1[side] - d2[side])/2\n  }\n\n  function _or(d, k) {\n   return d.hasOwnProperty('_'+k) ? d['_'+k] : d[k]\n  }\n\n  function Link(d, p) {\n    const hy = (d.y + (p.y - d.y) / 2)\n    return [\n      [d.x, d.y],\n      [d.x, hy],\n      [d.x, hy],\n      [p.x, hy],\n      [p.x, hy],\n      [p.x, p.y],\n    ]\n  }\n\n  function linkId(...args) {\n    return args.map(d => d.data.id).sort().join(\", \")  // make unique id\n  }\n\n  function otherParent(d, p1, data) {\n    return data.find(d0 => (d0.data.id !== p1.data.id) && ((d0.data.id === d.data.rels.mother) || (d0.data.id === d.data.rels.father)))\n  }\n}\n\n\n\n\n","import React from \"react\";\nimport f3 from \"./family-chart/index.js\"; // npm i family-chart\nimport \"./family-chart.css\"; // create file 'family-chart.css' in same directory, copy/paste css from examples/create-tree\nimport treeJsonData from '../src/json/family_tree.json'\n\nexport default class FamilyTree extends React.Component {\n  cont = React.createRef();\n\n  componentDidMount() {\n    if (!this.cont.current) return;\n\n    const store = f3.createStore({\n        data: treeJsonData,\n        node_separation: 250,\n        level_separation: 150\n      }),\n      view = f3.d3AnimationView({\n        store,\n        cont: document.querySelector(\"#FamilyChart\")\n      }),\n      Card = f3.elements.Card({\n        store,\n        svg: view.svg,\n        card_dim: {\n          w: 220,\n          h: 70,\n          text_x: 75,\n          text_y: 15,\n          img_w: 60,\n          img_h: 60,\n          img_x: 5,\n          img_y: 5\n        },\n        card_display: [\n          (d) => `${d.data[\"first name\"] || \"\"} ${d.data[\"last name\"] || \"\"}`,\n          (function (d) { if (d.data[\"nee\"]){\n            return \"nee \" + d.data[\"nee\"];\n          }\n          else {\n            return \"\";\n          }\n          }),\n          (d) => `${d.data[\"birthday\"] || \"\"}`\n        ],\n        mini_tree: true,\n        link_break: false,\n        infoLink: true,\n      });\n\n    view.setCard(Card);\n    store.setOnUpdate((props) => view.update(props || {}));\n    store.update.tree({ initial: true });\n\n  }\n\n  render() {\n    return <div className=\"f3\" id=\"FamilyChart\" ref={this.cont}></div>;\n  }\n}\n","import React from \"react\";\nimport FamilyChart from \"../src/FamilyChart\";\n  \nconst FamilyTree = () => {\n    return (\n        <div className=\"App\">\n          <FamilyChart />\n        </div>\n      );\n};\n  \nexport default FamilyTree;","import React, { useMemo } from \"react\";\nimport { useTable } from \"react-table\";\nimport pictureJsonData from '../src/json/picture_index.json'\n\nfunction processData(jsonData) {\n  const result = Object.keys(jsonData).map((key) => { \n    return jsonData[key];\n  });\n  return result;\n}\n\nconst Names = ({ row }) => {\n  var id_list = row.original.people;\n  \n  return (\n    <div style={{whiteSpace: \"pre-line\"}}>\n      {row.original.names.map( (current_row, index) =>\n        <div key={row.original.filename + \"_\" + index.toString()}>\n          {current_row.map( ( current_person, index2)=>\n            <span key={row.original.filename + \"_\" + index.toString() + \"_\" + index2.toString()}>\n              <a href={process.env.PUBLIC_URL + '#/person?id=' + id_list[index][index2]}>{current_person}</a>\n              {index2 + 1 < id_list[index].length ? \", \" : \"\"}\n            </span>\n          )}\n        </div>\n         )}\n    </div>\n  );\n};\n\nexport default function Pictures() {\n    const columns = useMemo(\n        () => [\n          {\n            Header: \"Filename\",\n            accessor: d => <a href = {process.env.PUBLIC_URL + '#/picture?name=' + d.filename}>{d.filename}</a>\n          },\n          {\n            Header: \"Date (Y/M/D)\",\n            accessor: d => `${d.date.year || \"?\"}/${d.date.month || \"?\"}/${d.date.day || \"?\"}`\n          },\n          {\n            Header: \"Location\",\n            accessor: \"location\"\n          },\n          {\n            Header: \"People\",\n            Cell: ({ row }) => <Names row={row} />\n          },\n          {\n            Header: \"Additional Information\",\n            accessor: \"additional info\"\n          },\n        ],\n        []\n      );\n\n\n      const [search, setSearch] = React.useState('');\n\n      const handleSearch = (event) => {\n        setSearch(event.target.value);\n      };\n\n      const processedPictureJsonData = processData(pictureJsonData);\n      // const data = React.useMemo(() => processedPictureJsonData, []);\n      const data = React.useMemo(\n        () =>\n          processedPictureJsonData.filter((picture) => {\n            return picture.names.join().toLowerCase().includes(search.toLowerCase());\n          }),\n        [search, processedPictureJsonData]\n      );\n    \n\n      const {\n        getTableProps, // table props from react-table\n        getTableBodyProps, // table body props from react-table\n        headerGroups, // headerGroups, if your table has groupings\n        rows, // rows for the table based on the data passed\n        prepareRow // Prepare the row (this function needs to be called for each row before getting the row props)\n      } = useTable({\n        columns,\n        data\n      });\n\n    \n      return (\n        <>\n          <label style={{margin: \"20px 0px 20px 0px\", display: \"inline-block\"}} htmlFor=\"search\">\n            Search People:{' '}\n            <input id=\"search\" type=\"text\" onChange={handleSearch} />\n          </label>\n          <table {...getTableProps()} border=\"collapse\">\n            <thead>\n              {headerGroups.map(headerGroup => (\n                <tr {...headerGroup.getHeaderGroupProps()}>\n                  {headerGroup.headers.map(column => (\n                    <th {...column.getHeaderProps()}>{column.render(\"Header\")}</th>\n                  ))}\n                </tr>\n              ))}\n            </thead>\n            <tbody {...getTableBodyProps()}>\n              {rows.map((row, i) => {\n                prepareRow(row);\n                return (\n                  <tr {...row.getRowProps()}>\n                    {row.cells.map(cell => {\n                      return <td {...cell.getCellProps()}>{cell.render(\"Cell\")}</td>;\n                    })}\n                  </tr>\n                );\n              })}\n            </tbody>\n          </table>\n        </>\n      );\n};","import React, { useMemo, useState } from \"react\";\nimport pictureJsonData from '../src/json/picture_index.json'\nimport { useSearchParams, Link } from 'react-router-dom';\n\n//take in json object of picture data, output array of [[category name, string information], ...] for each applicable category\nfunction formatPictureInformation(data){\n  var information_list = [];\n\n  //People\n  var people_string = \n  <div style={{whiteSpace: \"pre-line\"}}>\n    {data.names.map( (current_row, index) =>\n      <div key={data.filename + \"_\" + index.toString()}>\n        {current_row.map( ( current_person, index2)=>\n          <span key={data.filename + \"_\" + index.toString() + \"_\" + index2.toString()}>\n            <a href={process.env.PUBLIC_URL + '#/person?id=' + data.people[index][index2]}>{current_person}</a>\n            {index2 + 1 < data.people[index].length ? \", \" : \"\"}\n          </span>\n        )}\n      </div>\n      )}\n  </div>;\n\n  if (people_string !== \"\"){\n      information_list.push([\"People (Left to Right)\", people_string]);\n  }\n\n  //Date\n  var year = data.date.year;\n  var month = data.date.month;\n  var day = data.date.day;\n  var date_string = (year || \"?\") + \"/\" + (month || \"?\") + \"/\" + (day || \"?\");\n\n  if (date_string !== \"?/?/?\"){\n      information_list.push([\"Date (Y/M/D)\", date_string]);\n  }\n\n  //Location\n  if (data.location !== null){\n      information_list.push([\"Location\", data.location]);\n  }\n  \n  //Additional Info\n  if (data[\"additional info\"] !== null){\n      information_list.push([\"Additional Information\", data[\"additional info\"]]);\n  }\n\n  return information_list;\n}\n\nasync function formatPictureLabels(image_labels_loc, pictureData){\n  const label_data_text = await (await fetch(image_labels_loc)).text();\n  \n    //loop through the labels to pull out the people locations\n    var label_array = [];\n    var label_centroids_x = [];\n    var label_centroids_y = [];\n    label_data_text.split(\"\\n\").forEach((current_label) => {\n      var current_label_info = current_label.split(\" \");\n      //check that the label is a person\n      if (current_label_info[0] === \"0\"){\n        //add the x/y/w/h to the list\n        label_array.push(current_label_info.slice(1, 5).map(x=>parseFloat(x)));\n        label_centroids_x.push(parseFloat(current_label_info[1]));\n        label_centroids_y.push(parseFloat(current_label_info[2]));\n      }\n    });\n    //loop through the people in the information list, and for each of them, pick out their corresponding label\n    //for each row grab however many labels needed starting from the top\n    //then grab labels from that set ordered by position from the left\n    var label_jsx_list = [];\n\n    pictureData['names'].forEach( (name_row, row_index) =>{\n\n      //make a list of the labels starting from the top\n      let cur_label_array = [];\n      let cur_label_centroids_x = [];\n      for (let i = 0; i < name_row.length; i++){\n        if (label_array.length === 0){\n          continue;\n        }\n        let cur_label_index = argMin(label_centroids_y);\n        //add to cur_label_array\n        cur_label_array.push(label_array[cur_label_index]);\n        cur_label_centroids_x.push(label_centroids_x[cur_label_index]);\n        //remove from the other arrays\n        label_array.splice(cur_label_index, 1);\n        label_centroids_x.splice(cur_label_index, 1);\n        label_centroids_y.splice(cur_label_index, 1);\n      }\n\n      //pull out the people starting from the left\n      name_row.forEach( (name, column_index) => {\n        if (cur_label_array.length === 0){\n          return;\n        }\n        let cur_label_index = argMin(cur_label_centroids_x);\n        //grab x/y/w/h\n        let cur_label = cur_label_array[cur_label_index];\n        //remove from the arrays\n        cur_label_array.splice(cur_label_index, 1);\n        cur_label_centroids_x.splice(cur_label_index, 1);\n\n        let style = {\n          position: \"absolute\",\n          background: \"rgba(255, 255, 255, 0.4)\",\n          border: \"none\",\n          opacity: \"0\",\n          color: \"black\", textDecoration: \"none\",\n          display: \"flex\",flexDirection: \"row\",justifyContent: \"center\",alignItems: \"center\",textAlign: \"center\",\n          left: ((cur_label[0] - cur_label[2] / 2)*50).toFixed(0) + \"%\",\n          top: ((cur_label[1] - cur_label[3] / 2)*100).toFixed(0) + \"%\",\n          width: (cur_label[2]*50).toFixed(0) + \"%\",\n          height: (cur_label[3]*100).toFixed(0) + \"%\",\n        };\n\n        label_jsx_list.push(\n          // <button onMouseOver={labelMouseOver} onMouseOut={labelMouseOut} key={\"label_\" + name} style={style}\n          // onClick={\"location.href='\" + process.env.PUBLIC_URL + '#/person?id=' + pictureData['people'][row_index][column_index]+\"'\"}>\n          //   {name}\n          // </button>\n          <Link onMouseOver={labelMouseOver} onMouseOut={labelMouseOut} key={\"label_\" + column_index.toString() + row_index.toString()} \n          style={style} \n          to={{ pathname: '/person', search: \"id=\" + pictureData['people'][row_index][column_index] }} className=\"btn btn-primary\">\n            {name}\n          </Link>\n        );\n\n      });\n    });\n    return label_jsx_list;\n}\n\nfunction argMin(array) {\n  return array.map((x, i) => [x, i]).reduce((r, a) => (a[0] < r[0] ? a : r))[1];\n}\n\nfunction labelMouseOver(event) {\n  event.target.style.opacity = \"1\";\n}\nfunction labelMouseOut(event){\n  event.target.style.opacity = \"0\";\n}\n\n//main function\nexport default function Picture() {\n  const [labels, setLabels] = useState();\n  const [searchParams] = useSearchParams();\n  var image_name = searchParams.get('name');\n\n  //grab the image and labels\n  var image_loc = process.env.PUBLIC_URL + '/pictures/' + image_name + \".png\";\n  var image_labels_loc = process.env.PUBLIC_URL + '/pictures/labels/' + image_name + \".txt\";\n\n  //go through the json data and pull out the relevant info\n  var information_list = [];\n  var picture_data = {};\n  for (var i = 0; i < pictureJsonData.length; i++) {\n    if (pictureJsonData[i]['filename'] === image_name){\n        //found the right image data\n        picture_data = pictureJsonData[i];\n        information_list = formatPictureInformation(picture_data);\n\n    }\n  }\n\n  //add the labels\n  useMemo(async () => {\n    let response = await formatPictureLabels(image_labels_loc, picture_data);\n    setLabels(response)\n  }, [image_labels_loc, picture_data])\n\n  \n  let style = {\n    position: \"relative\"\n  };\n  return (\n    <div>\n      <div key=\"image\" style={style}>\n        <img src={image_loc} width=\"50%\" alt=\"Not found\" />\n        {labels}\n      </div>\n      <table>\n        <thead>\n        </thead>\n        <tbody>\n        {information_list.map((information_row, index) => (\n            <tr key={index}>\n                <td>{information_row[0]}</td>\n                <td>{information_row[1]}</td>\n            </tr>\n        ))}\n        </tbody>\n      </table>\n    </div>\n  );\n}","import React from \"react\";\nimport orderedTreeJsonData from '../src/json/family_tree_ordered.json'\nimport { Link } from 'react-router-dom';\n\n//take in a person's ID, output a list of jsx elements by category\n//e.g. [['father', <a href=\"link\">Dad</a>], ['spouses', <><a>spouse1</a>, <a>spouse2</a></>] ]\nexport function personRelativesList(person_id)\n{\n    var output_list = [];\n\n    //parents\n    ['Mother', 'Father'].forEach( element =>{\n        var cur_id = orderedTreeJsonData[person_id][\"rels\"][element.toLowerCase()];\n        if (cur_id)\n        {\n            var parent_link = \n                <span key={\"parent \" + cur_id}>\n                    <Link to={{ pathname: '/person', search: \"id=\" + cur_id }}>\n                        {nameFromId(cur_id)}\n                    </Link>\n                </span>;\n            output_list.push([element, parent_link]);\n        }\n    });\n\n    //spouses and children\n    ['Spouses', 'Children'].forEach( element =>{\n        var cur_ids = orderedTreeJsonData[person_id][\"rels\"][element.toLowerCase()];\n        if (cur_ids)\n        {\n            var spouses_list = \n                <div key={person_id}>\n                    {cur_ids.map( ( current_id, index )=>\n                    <span key={person_id + current_id}>\n                        <Link to={{ pathname: '/person', search: \"id=\" + current_id }}>\n                            {nameFromId(current_id)}\n                        </Link>\n                        {index + 1 < cur_ids.length ? \", \" : \"\"}\n                    </span>\n                    )}\n                </div>;\n            output_list.push([element, spouses_list]);\n        }\n    });\n    \n\n    return output_list;\n}\n\nfunction nameFromId(person_id){\n    var name = `${orderedTreeJsonData[person_id]['data']['first name'] || \"?\"} ${orderedTreeJsonData[person_id]['data']['last name'] || \"?\"}`;\n    return name;\n}\n","import React from \"react\";\nimport treeJsonData from '../src/json/family_tree.json'\nimport pictureJsonData from '../src/json/picture_index.json'\nimport '../src/person_utils'\nimport { personRelativesList } from \"../src/person_utils\";\nimport { useSearchParams, Link } from 'react-router-dom';\n\n//take in json object of picture data, output array of [[category name, string information], ...] for each applicable category\nfunction formatPersonInformation(data){\n  const italic_style = {\n    fontStyle: 'italic'\n  };\n  \n  var information_list = [];\n\n  //Name info\n  var name = \n  <>\n    {(data[\"data\"][\"first name\"] || \"?\") + \" \"}\n    {data[\"data\"][\"nickname\"] ? '\"' + data[\"data\"][\"nickname\"] + '\" ' : \"\"}\n    {data[\"data\"][\"last name\"] || \"?\"}\n    <span style={italic_style}>{data[\"data\"][\"nee\"] ? \" (nee \" + data[\"data\"][\"nee\"] + \")\" : \"\"}</span>\n  </>;\n  information_list.push([\"Name\", name]);\n\n  var personal_data_list = [\"Birthday\", \"Birthplace\", \"Deathplace\", \"Other info\", \"Gender\"];\n\n  personal_data_list.forEach(element => {\n    if (data[\"data\"][element.toLowerCase()]){\n      information_list.push([element, data[\"data\"][element.toLowerCase()]]);\n    }\n  });\n\n  var relatives_list = personRelativesList(data['id']);\n  information_list = information_list.concat(relatives_list);\n\n  return information_list;\n}\n\nfunction getPersonPictures(person_id){\n  var pictures_jsx = [];\n  pictureJsonData.forEach( pictureJson => {\n    if (pictureJson['people'].some(row => row.includes(person_id))){\n      var image_loc = process.env.PUBLIC_URL + '/pictures/' + pictureJson['filename'] + \".png\";\n\n      pictures_jsx.push(\n        <Link key={\"pic_\" + pictureJson['filename']} \n          to={{ pathname: '/picture', search: \"name=\" + pictureJson['filename'] }}>\n            <img src={image_loc} width=\"100px\" alt=\"Not found\" />\n        </Link>\n      );\n    }\n  });\n\n  return pictures_jsx;\n}\n\nexport default function Person() {\n  const [searchParams] = useSearchParams();\n  var person_id = searchParams.get('id');\n\n  //format the person's information\n  var information_list = [];\n  for (var i = 0; i < treeJsonData.length; i++) {\n    if (treeJsonData[i]['id'] === person_id){\n        //found the right image data\n        information_list = formatPersonInformation(treeJsonData[i]);\n    }\n  }\n  if (information_list.length === 0){\n    return <div>Person was not found</div>\n  }\n\n  //get a list of all pictures the person is in\n  var pictures_jsx = getPersonPictures(person_id);\n\n  return (\n    <div>\n    <table>\n      <thead>\n      </thead>\n      <tbody>\n      {information_list.map((information_row, index) => (\n          <tr key={index}>\n              <td>{information_row[0]}</td>\n              <td>{information_row[1]}</td>\n          </tr>\n      ))}\n      </tbody>\n    </table>\n    <br/>Pictures:<br/>\n    {pictures_jsx}\n    </div>\n  );\n}","import React from 'react';\nimport Navbar from './components/Navbar';\nimport { HashRouter as Router, Routes, Route}\n    from 'react-router-dom';\nimport FamilyTree from './pages/familyTree';\nimport Pictures from './pages/pictures';\nimport Picture from './pages/picture';\nimport Person from './pages/person';\n  \nfunction App() {\nreturn (\n    <Router>\n    <Navbar />\n    <Routes>\n        <Route path='/family-tree' element={<FamilyTree/>} />\n        <Route path='/pictures' element={<Pictures/>} />\n        <Route path='/picture' element={<Picture/>} />\n        <Route path='/person' element={<Person/>} />\n    </Routes>\n    </Router>\n);\n}\n  \nexport default App;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n  \nReactDOM.render(\n<React.StrictMode>\n      <App />\n</React.StrictMode>,\ndocument.getElementById('root')\n);"],"sourceRoot":""}