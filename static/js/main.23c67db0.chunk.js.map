{"version":3,"sources":["components/Navbar/NavbarElements.js","components/Navbar/index.js","pages/login.js","src/family-chart/d3.js","src/family-chart/CalculateTree/CalculateTree.handlers.js","src/family-chart/handlers/checkIfRelativesConnectedWithoutPerson.js","src/family-chart/handlers/general.js","src/family-chart/handlers/newPerson.js","src/family-chart/CalculateTree/CalculateTree.js","src/family-chart/view/View.handlers.js","src/family-chart/view/elements/Link.js","src/family-chart/view/elements/Card.Elements.js","src/family-chart/handlers/cardMethods.js","src/family-chart/view/elements/Card.js","src/family-chart/AddRelativeTree/AddRelativeTree.CalculateTree.js","src/family-chart/AddRelativeTree/AddRelativeTree.View.js","src/family-chart/AddRelativeTree/AddRelativeTree.AddRelative.js","src/family-chart/AddRelativeTree/AddRelativeTree.js","src/family-chart/index.js","src/family-chart/createStore.js","src/family-chart/view/View.d3Animation.js","src/family-chart/CalculateTree/createLinks.js","src/FamilyChart.js","pages/familyTree.js","pages/pictures.js","pages/picture.js","src/person_utils.js","pages/people.js","pages/person.js","App.js","index.js"],"names":["Nav","styled","nav","NavLink","Link","NavMenu","FaBars","div","Navbar","to","activestyle","setLoginToken","validateLogin","password","document","getElementById","value","test_ascii_list_1","test_ascii_list_2","password_1","slice","password_2","password_result_1","password_result_2","BigInt","charCodeAt","push","console","log","textContent","Login","props","className","id","type","onClick","window","d3","_d3","otherParent","d","p1","data","find","d0","rels","mother","father","calculateEnterAndExitPositions","entering","exiting","depth","spouse","_x","x","_y","y","is_ancestry","parent","psx","toggleRels","tree_datum","hide_rels","rels_","showHideAncestry","rel_type","main","children","spouses","forEach","sp","ch_id","includes","splice","indexOf","showHideChildren","toggleAllRels","tree_data","checkIfRelativesConnectedWithoutPerson","datum","data_stash","r","r_ids","filter","r_id","rels_not_to_main","i","without_persons","line","isM","checkIfAnyRelIsMain","history","runAllRels","f","d_id","findPersonLineToMain","length","moveToAddToAdded","to_add","removeToAdd","deletePerson","k","hasOwnProperty","Array","isArray","findIndex","did","createTreeDataWithMainNode","success","error","manualZoom","amount","svg","transition_time","zoom","__zoomObj","select","transition","duration","delay","call","scaleBy","isAllRelativeDisplayed","v","every","rel_id","some","generateUUID","Date","getTime","d2","performance","now","replace","c","Math","random","floor","toString","handleRelsOfNewDatum","rel_datum","addSpouse","spouse_id","removeIfToAdd","other_parent","new_spouse","createNewPersonWithGenderFromRel","addNewPerson","addOtherParent","gender","addChildToSpouseAndParentToChild","addChild","is_father","parent_to_add_id","handleSpouse","addParent","createNewPerson","getGenderFromRelative","Object","assign","version","addNewPersonAndHandleRels","CalculateTree","main_id","is_vertical","node_separation","level_separation","to_add_spouses","child","d1","createToAddSpouse","createRelsToAdd","sort","a","b","a_d","b_d","a_p2","b_p2","a_i","b_i","tree_children","calculateTreePositions","tree_parents","parents","mid_diff","levelOutEachSide","tree","setupChildrenAndParents","side","sp_id","added","sx","p2","midd","setupSpouses","d_x","nodePositioning","dim","w_extent","extent","h_extent","width","height","x_off","y_off","calculateTreeDim","rt","hierarchyGetter","map","d3_tree","nodeSize","separation","offset","sameParent","hasSpouses","someSpouses","max","offsetOnPartners","sameBothParents","root","hierarchy","descendants","positionTree","t","transform","zoomIdentity","scale","translate","treeFit","svg_dim","tree_dim","with_transition","min","calculateTreeFit","createPath","is_","curve","curveMonotoneY","lineCurve","curveBasis","path_data","_d","CardBody","card_dim","card_display","template","w","h","text_x","text_y","CardBodyAddNew","card_add","label","CardBodyOutline","is_new","PencilIcon","HideIcon","MiniTree","PlusIcon","InfoIcon","LinkBreakIcon","closed","LinkBreakIconWrapper","g","_r","_rels","areParents","areChildren","sp_r","_sp_r","CardImage","image","maleIcon","femaleIcon","img_x","img_y","process","img_h","img_w","cardChangeMain","store","card","getTree","update","mainId","tree_position","cardEdit","cardEditForm","postSubmit","getData","delete","cardShowHideRels","Card","default_props","mini_tree","link_break","setupProps","querySelector","curvedRectPath","no_curve_corners","ncc","ncc_check","corner","lx","rx","ry","ly","insertAdjacentHTML","setupSvgDefs","node","el","createElementNS","gender_class","show_mini_tree","state","unknown_lbl","innerHTML","avatar","infoLink","p","addEventListener","e","stopPropagation","addRelative","open","setupListeners","labels","lbls","fn","ln","son","daughter","View","cont","getBoundingClientRect","tree_fit","s","is_main","pos","color_class","mounted","view","closest","getAttribute","new_datum","remove","handleCardClick","target","AddRelative","innerWidth","div_add_relative","createElement","style","cssText","appendChild","AddRelativeTree","createStore","initial_state","onUpdate","setOnUpdate","methods","d3AnimationView","svg_html","fake_cont","firstElementChild","createSvg","zoom_polite","__zoom","on","attr","ctrlKey","touches","setupZoom","setupSvg","checked","selectAll","card_exit","exit","card_enter","enter","append","card_update","merge","CardElement","CardDefault","each","this","calculateDelay","updateCards","links_data","reduce","acc","concat","links","_or","join","getMid","linkId","handleAncestrySide","handleProgenySide","hy","args","createLinks","link","link_exit","link_enter","link_update","path","updateLinks","initial","mainToMiddle","ancestry_levels","setCard","handlers","elements","FamilyTree","React","createRef","updateTree","selectedOptions","setState","current","f3","person_id","treeJsonData","styles","options","float","people_options","person","name","defaultChecked","htmlFor","ref","onChange","Component","useSearchParams","get","Names","row","id_list","original","people","whiteSpace","names","current_row","index","key","filename","current_person","index2","href","Pictures","jsonData","columns","useMemo","Header","accessor","date","year","month","day","Cell","useState","search","setSearch","processedPictureJsonData","pictureJsonData","keys","picture","toLowerCase","useTable","getTableProps","getTableBodyProps","headerGroups","rows","prepareRow","margin","display","event","headerGroup","getHeaderGroupProps","headers","column","getHeaderProps","render","getRowProps","cells","cell","getCellProps","formatPictureInformation","information_list","people_string","date_string","location","formatPictureLabels","image_labels_loc","pictureData","fetch","text","label_data_text","label_array","label_centroids_x","label_centroids_y","split","current_label","current_label_info","parseFloat","label_jsx_list","name_row","row_index","cur_label_array","cur_label_centroids_x","cur_label_index","argMin","column_index","cur_label","position","background","border","opacity","color","textDecoration","flexDirection","justifyContent","alignItems","textAlign","left","toFixed","top","onMouseOver","labelMouseOver","onMouseOut","labelMouseOut","pathname","array","Picture","setLabels","image_name","image_loc","picture_data","response","src","alt","information_row","nameFromId","orderedTreeJsonData","italic_style","fontStyle","People","processedTreeJsonData","formatPersonInformation","element","relatives_list","output_list","cur_id","parent_link","cur_ids","spouses_list","current_id","personRelativesList","Person","avatar_loc","pictures_jsx","pictureJson","getPersonPictures","App","localStorage","getItem","loginToken","authstore","useEffect","setItem","ReactDOM","StrictMode"],"mappings":"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","file":"static/js/main.23c67db0.chunk.js","sourcesContent":["import { FaBars } from \"react-icons/fa\";\nimport { NavLink as Link } from \"react-router-dom\";\nimport styled from \"styled-components\";\n  \nexport const Nav = styled.nav`\n  background: transparent;\n  border-style: solid;\n  height: 85px;\n  display: flex;\n  justify-content: space-between;\n  z-index: 12;\n`;\n  \nexport const NavLink = styled(Link)`\n  color: #808080;\n  display: flex;\n  align-items: center;\n  text-decoration: none;\n  padding: 0 1rem;\n  height: 100%;\n  cursor: pointer;\n  &.active {\n    color: #000000;\n  }\n  &:hover,\n  &:focus {\n    color: blue;\n  }\n`;\n  \nexport const Bars = styled(FaBars)`\n  display: none;\n  color: #808080;\n  @media screen and (max-width: 768px) {\n    display: block;\n    position: absolute;\n    top: 0;\n    right: 0;\n    transform: translate(-100%, 75%);\n    font-size: 1.8rem;\n    cursor: pointer;\n  }\n`;\n  \nexport const NavMenu = styled.div`\n  display: flex;\n  align-items: center;\n  margin-right: -24px;\n  @media screen and (max-width: 768px) {\n    display: none;\n  }\n`;","import React from \"react\";\nimport { Nav, NavLink, NavMenu } \n    from \"./NavbarElements\";\n  \nconst Navbar = () => {\n  return (\n    <>\n      <Nav>\n        <NavMenu>\n          <NavLink to=\"/family-tree\" activestyle=\"true\">\n            Family Tree\n          </NavLink>\n          <NavLink to=\"/people\" activestyle=\"true\">\n            People\n          </NavLink>\n          <NavLink to=\"/pictures\" activestyle=\"true\">\n            Pictures\n          </NavLink>\n        </NavMenu>\n      </Nav>\n    </>\n  );\n};\n  \nexport default Navbar;","import React from 'react';\n/* global BigInt */\n\nvar setLoginToken = null;\n\nfunction validateLogin(){\n  //https://bigprimes.org/\n  var password = document.getElementById(\"password\").value;\n  var master_password = 899698826925408217616668411965875890691630320222587056493923n;\n\n  // var test = 1n;\n  // var test_ascii_list = [];\n\n  // while (test !== 0n){\n  //   test_ascii_list.unshift(Number(test % 64n) + 33);\n  //   test = test >> 6n;\n  // }\n  // console.log(String.fromCodePoint(...test_ascii_list));\n\n\n  var test_ascii_list_1 = [];\n  var test_ascii_list_2 = [];\n\n  var password_1 = password.slice(0, 17);\n  var password_2 = password.slice(17);\n\n\n  var password_result_1 = 0n\n  var password_result_2 = 0n\n\n  while (password_1 !== \"\"){\n    password_result_1 = password_result_1 << 6n;\n    password_result_1 += BigInt(password_1.charCodeAt(0)) - 33n;\n    test_ascii_list_1.push(password_1.charCodeAt(0));\n    password_1 = password_1.slice(1);\n  }\n  while (password_2 !== \"\"){\n    password_result_2 = password_result_2 << 6n;\n    password_result_2 += BigInt(password_2.charCodeAt(0)) - 33n;\n    test_ascii_list_2.push(password_2.charCodeAt(0));\n    password_2 = password_2.slice(1);\n  }\n\n  var password_result = password_result_1 * password_result_2;\n\n  if (password_result === master_password){\n    console.log(\"match\");\n    setLoginToken(true);\n  }\n  else {\n    document.getElementById(\"loginResult\").textContent=\"Login Failed\";\n  }\n}\n\nexport default function Login(props) {\n  setLoginToken = props.setLoginToken;\n  return(\n    <>\n      <style>{`\n        .login-wrapper {\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n        }\n\n      `}</style>\n      <div className=\"login-wrapper\">\n        <h1>Please Log In</h1>\n        <form>\n          <label>\n            <p>Username</p>\n            <input id=\"username\" type=\"text\" />\n          </label>\n          <label>\n            <p>Password</p>\n            <input id=\"password\" type=\"password\" />\n          </label>\n          <div>\n            <br/>\n            <button onClick={validateLogin} type=\"submit\">Submit</button>\n          </div>\n          <br/>\n          <span id=\"loginResult\">  </span>\n        </form>\n      </div>\n    </>\n  )\n}\n","import * as _d3 from 'd3';\nexport default typeof window === \"object\" && !!window.d3 ? window.d3 : _d3;","export function sortChildrenWithSpouses(data) {\n  data.forEach(datum => {\n    if (!datum.rels.children) return\n    datum.rels.children.sort((a, b) => {\n      const a_d = data.find(d => d.id === a),\n        b_d = data.find(d => d.id === b),\n        a_p2 = otherParent(a_d, datum, data) || {},\n        b_p2 = otherParent(b_d, datum, data) || {},\n        a_i = datum.rels.spouses.indexOf(a_p2.id),\n        b_i = datum.rels.spouses.indexOf(b_p2.id)\n\n      if (datum.data.gender === \"M\") return a_i - b_i\n      else return b_i - a_i\n    })\n  })\n}\n\nfunction otherParent(d, p1, data) {\n  return data.find(d0 => (d0.id !== p1.id) && ((d0.id === d.rels.mother) || (d0.id === d.rels.father)))\n}\n\nexport function calculateEnterAndExitPositions(d, entering, exiting) {\n  d.exiting = exiting\n  if (entering) {\n    if (d.depth === 0 && !d.spouse) {d._x = d.x; d._y = d.y}\n    else if (d.spouse) {d._x = d.spouse.x; d._y = d.spouse.y;}\n    else if (d.is_ancestry) {d._x = d.parent.x; d._y = d.parent.y;}\n    else {d._x = d.psx; d._y = d.parent.y;}\n  } else if (exiting) {\n    const x = d.x > 0 ? 1 : -1,\n      y = d.y > 0 ? 1 : -1\n    d._x = d.x+400*x; d._y = d.y+400*y;\n  }\n}\n\nexport function toggleRels(tree_datum, hide_rels) {\n  const\n    rels = hide_rels ? 'rels' : '_rels',\n    rels_ = hide_rels ? '_rels' : 'rels'\n  \n  if (tree_datum.is_ancestry || tree_datum.data.main) {showHideAncestry('father'); showHideAncestry('mother')}\n  else {showHideChildren()}\n\n  function showHideAncestry(rel_type) {\n    if (!tree_datum.data[rels] || !tree_datum.data[rels][rel_type]) return\n    if (!tree_datum.data[rels_]) tree_datum.data[rels_] = {}\n    tree_datum.data[rels_][rel_type] = tree_datum.data[rels][rel_type]\n    delete tree_datum.data[rels][rel_type]\n  }\n\n  function showHideChildren() {\n    if (!tree_datum.data[rels] || !tree_datum.data[rels].children) return\n    const\n      children = tree_datum.data[rels].children.slice(0),\n      spouses = tree_datum.spouse ? [tree_datum.spouse] : tree_datum.spouses || [];\n\n    [tree_datum, ...spouses].forEach(sp => children.forEach(ch_id => {\n      if (sp.data[rels].children.includes(ch_id)) {\n        if (!sp.data[rels_]) sp.data[rels_] = {}\n        if (!sp.data[rels_].children) sp.data[rels_].children = []\n        sp.data[rels_].children.push(ch_id)\n        sp.data[rels].children.splice(sp.data[rels].children.indexOf(ch_id), 1)\n      }\n    }))\n  }\n}\n\nexport function toggleAllRels(tree_data, hide_rels) {\n  tree_data.forEach(d => {d.data.hide_rels = hide_rels; toggleRels(d, hide_rels)})\n}\n\n","export function checkIfRelativesConnectedWithoutPerson(datum, data_stash) {\n  const r = datum.rels,\n    r_ids = [r.father, r.mother, ...(r.spouses || []), ...(r.children || [])].filter(r_id => !!r_id),\n    rels_not_to_main = [];\n\n  for (let i = 0; i < r_ids.length; i++) {\n    const line = findPersonLineToMain(data_stash.find(d => d.id === r_ids[i]), [datum])\n    if (!line) {rels_not_to_main.push(r_ids[i]); break;}\n  }\n  return rels_not_to_main.length === 0;\n\n  function findPersonLineToMain(datum, without_persons) {\n    let line;\n    if (isM(datum)) line = [datum]\n    checkIfAnyRelIsMain(datum, [datum])\n    return line\n\n    function checkIfAnyRelIsMain(d0, history) {\n      if (line) return\n      history = [...history, d0];\n      runAllRels(check);\n      if (!line) runAllRels(checkRels);\n\n      function runAllRels(f) {\n        const r = d0.rels;\n        [r.father, r.mother, ...(r.spouses || []), ...(r.children || [])]\n          .filter(d_id => (d_id && ![...without_persons, ...history].find(d => d.id === d_id)))\n          .forEach(d_id => f(d_id));\n      }\n\n      function check(d_id) {\n        if (isM(d_id)) line = history\n      }\n\n      function checkRels(d_id) {\n        const person = data_stash.find(d => d.id === d_id)\n        checkIfAnyRelIsMain(person, history)\n      }\n    }\n  }\n  function isM(d0) {return typeof d0 === 'object' ? d0.id === data_stash[0].id : d0 === data_stash[0].id}  // todo: make main more exact\n}","import d3 from \"../d3.js\"\nimport {checkIfRelativesConnectedWithoutPerson} from \"./checkIfRelativesConnectedWithoutPerson.js\"\nimport {createTreeDataWithMainNode} from \"./newPerson.js\"\n\nexport function moveToAddToAdded(datum, data_stash) {\n  delete datum.to_add\n  return datum\n}\n\nexport function removeToAdd(datum, data_stash) {\n  deletePerson(datum, data_stash)\n  return false\n}\n\nexport function deletePerson(datum, data_stash) {\n  if (!checkIfRelativesConnectedWithoutPerson(datum, data_stash)) return {success: false, error: 'checkIfRelativesConnectedWithoutPerson'}\n  executeDelete()\n  return {success: true};\n\n  function executeDelete() {\n    data_stash.forEach(d => {\n      for (let k in d.rels) {\n        if (!d.rels.hasOwnProperty(k)) continue\n        if (d.rels[k] === datum.id) {\n          delete d.rels[k]\n        } else if (Array.isArray(d.rels[k]) && d.rels[k].includes(datum.id)) {\n          d.rels[k].splice(d.rels[k].findIndex(did => did === datum.id), 1)\n        }\n      }\n    })\n    data_stash.splice(data_stash.findIndex(d => d.id === datum.id), 1)\n    data_stash.forEach(d => {if (d.to_add) deletePerson(d, data_stash)})  // full update of tree\n    if (data_stash.length === 0) data_stash.push(createTreeDataWithMainNode({}).data[0])\n  }\n}\n\nexport function manualZoom({amount, svg, transition_time=500}) {\n  const zoom = svg.__zoomObj\n  d3.select(svg).transition().duration(transition_time || 0).delay(transition_time ? 100 : 0)  // delay 100 because of weird error of undefined something in d3 zoom\n    .call(zoom.scaleBy, amount)\n}\n\nexport function isAllRelativeDisplayed(d, data) {\n  const r = d.data.rels,\n    all_rels = [r.father, r.mother, ...(r.spouses || []), ...(r.children || [])].filter(v => v)\n  return all_rels.every(rel_id => data.some(d => d.data.id === rel_id))\n}\n\nexport function generateUUID() {\n  var d = new Date().getTime();\n  var d2 = (performance && performance.now && (performance.now()*1000)) || 0;//Time in microseconds since page-load or 0 if unsupported\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    var r = Math.random() * 16;\n    if(d > 0){//Use timestamp until depleted\n      r = (d + r)%16 | 0;\n      d = Math.floor(d/16);\n    } else {//Use microseconds since page-load if supported\n      r = (d2 + r)%16 | 0;\n      d2 = Math.floor(d2/16);\n    }\n    return (c === 'x' ? r : ((r & 0x3) | 0x8)).toString(16);\n  });\n}\n","import {generateUUID, removeToAdd} from \"./general.js\";\n\nexport function handleRelsOfNewDatum({datum, data_stash, rel_type, rel_datum}) {\n  if (rel_type === \"daughter\" || rel_type === \"son\") addChild(datum)\n  else if (rel_type === \"father\" || rel_type === \"mother\") addParent(datum)\n  else if (rel_type === \"spouse\") addSpouse(datum)\n\n  function addChild(datum) {\n    if (datum.data.other_parent) {\n      addChildToSpouseAndParentToChild(datum.data.other_parent)\n      delete datum.data.other_parent\n    }\n    datum.rels[rel_datum.data.gender === 'M' ? 'father' : 'mother'] = rel_datum.id\n    if (!rel_datum.rels.children) rel_datum.rels.children = []\n    rel_datum.rels.children.push(datum.id)\n    return datum\n\n    function addChildToSpouseAndParentToChild(spouse_id) {\n      if (spouse_id === \"_new\") spouse_id = addOtherParent().id;\n\n      const spouse = data_stash.find(d => d.id === spouse_id)\n      datum.rels[spouse.data.gender === 'M' ? 'father' : 'mother'] = spouse.id\n      if (!spouse.rels.hasOwnProperty('children')) spouse.rels.children = []\n      spouse.rels.children.push(datum.id)\n\n      function addOtherParent() {\n        const new_spouse = createNewPersonWithGenderFromRel({rel_type: \"spouse\", rel_datum})\n        addSpouse(new_spouse)\n        addNewPerson({data_stash, datum: new_spouse})\n        return new_spouse\n      }\n    }\n  }\n\n  function addParent(datum) {\n    const is_father = datum.data.gender === \"M\",\n      parent_to_add_id = rel_datum.rels[is_father ? 'father' : 'mother'];\n    if (parent_to_add_id) removeToAdd(data_stash.find(d => d.id === parent_to_add_id), data_stash)\n    addNewParent()\n\n    function addNewParent() {\n      rel_datum.rels[is_father ? 'father' : 'mother'] = datum.id\n      handleSpouse()\n      datum.rels.children = [rel_datum.id]\n      return datum\n\n      function handleSpouse() {\n        const spouse_id = rel_datum.rels[!is_father ? 'father' : 'mother']\n        if (!spouse_id) return\n        const spouse = data_stash.find(d => d.id === spouse_id)\n        datum.rels.spouses = [spouse_id]\n        if (!spouse.rels.spouses) spouse.rels.spouses = []\n        spouse.rels.spouses.push(datum.id)\n        return spouse\n      }\n    }\n  }\n\n  function addSpouse(datum) {\n    removeIfToAdd();\n    if (!rel_datum.rels.spouses) rel_datum.rels.spouses = []\n    rel_datum.rels.spouses.push(datum.id);\n    datum.rels.spouses = [rel_datum.id];\n\n    function removeIfToAdd() {\n      if (!rel_datum.rels.spouses) return\n      rel_datum.rels.spouses.forEach(spouse_id => {\n        const spouse = data_stash.find(d => d.id === spouse_id);\n        if (spouse.to_add) removeToAdd(spouse, data_stash)\n      })\n    }\n  }\n}\n\nexport function createNewPerson({data, rels}) {\n  return {id: generateUUID(), data: data || {}, rels: rels || {}}\n}\n\nexport function createNewPersonWithGenderFromRel({data, rel_type, rel_datum}) {\n  const gender = getGenderFromRelative(rel_datum, rel_type)\n  data = Object.assign(data || {}, {gender})\n  return createNewPerson({data})\n\n  function getGenderFromRelative(rel_datum, rel_type) {\n    return ([\"daughter\", \"mother\"].includes(rel_type) || (rel_type === \"spouse\" && rel_datum.data.gender === \"M\")) ? \"F\" : \"M\"\n  }\n}\n\nexport function addNewPerson({data_stash, datum}) {\n  data_stash.push(datum)\n}\n\nexport function createTreeDataWithMainNode({data, version}) {\n  return {data: [createNewPerson({data})], version}\n}\n\nexport function addNewPersonAndHandleRels({datum, data_stash, rel_type, rel_datum}) {\n  addNewPerson({data_stash, datum})\n  handleRelsOfNewDatum({datum, data_stash, rel_type, rel_datum})\n}\n","import d3 from \"../d3.js\"\nimport {sortChildrenWithSpouses} from \"./CalculateTree.handlers.js\"\nimport {createNewPerson} from \"../handlers/newPerson.js\"\n\nexport default function CalculateTree({data_stash, main_id=null, is_vertical=true, node_separation=250, level_separation=150}) {\n  data_stash = createRelsToAdd(data_stash)\n  sortChildrenWithSpouses(data_stash)\n  const main = main_id !== null ? data_stash.find(d => d.id === main_id) : data_stash[0],\n    tree_children = calculateTreePositions(main, 'children', false),\n    tree_parents = calculateTreePositions(main, 'parents', true)\n\n  data_stash.forEach(d => d.main = d === main)\n  levelOutEachSide(tree_parents, tree_children)\n  const tree = mergeSides(tree_parents, tree_children)\n  setupChildrenAndParents({tree})\n  setupSpouses({tree, node_separation})\n  nodePositioning({tree, is_vertical})\n\n  const dim = calculateTreeDim(tree, node_separation, level_separation, is_vertical)\n\n  return {data: tree, data_stash, dim}\n\n  function calculateTreePositions(datum, rt, is_ancestry) {\n    const hierarchyGetter = rt === \"children\" ? hierarchyGetterChildren : hierarchyGetterParents,\n      d3_tree = d3.tree().nodeSize([node_separation, level_separation]).separation(separation),\n      root = d3.hierarchy(datum, hierarchyGetter);\n    d3_tree(root);\n    return root.descendants()\n\n    function separation(a, b) {\n      let offset = 1;\n      if (!is_ancestry) {\n        if (!sameParent(a, b)) offset+=.25\n        if (someSpouses(a,b)) offset+=offsetOnPartners(a,b)\n        if (sameParent(a, b) && !sameBothParents(a,b)) offset+=.125\n      }\n      return offset\n    }\n\n    //function hasCh(d) {return !!d.children}\n    function sameParent(a, b) {return a.parent === b.parent}\n    function sameBothParents(a, b) {return (a.data.rels.father === b.data.rels.father) && (a.data.rels.mother === b.data.rels.mother)}\n    //function someChildren(a, b) {return hasCh(a) || hasCh(b)}\n    function hasSpouses(d) {return d.data.rels.spouses && d.data.rels.spouses.length > 0}\n    function someSpouses(a, b) {return hasSpouses(a) || hasSpouses(b)}\n\n    function hierarchyGetterChildren(d) {\n      return [...(d.rels.children || [])].map(id => data_stash.find(d => d.id === id))\n    }\n\n    function hierarchyGetterParents(d) {\n      return [d.rels.father, d.rels.mother]\n        .filter(d => d).map(id => data_stash.find(d => d.id === id))\n    }\n\n    function offsetOnPartners(a,b) {\n      return (Math.max((a.data.rels.spouses || []).length, (b.data.rels.spouses || []).length))*.5+.5\n    }\n  }\n\n  function levelOutEachSide(parents, children) {\n    const mid_diff = (parents[0].x - children[0].x) / 2\n    parents.forEach(d => d.x-=mid_diff)\n    children.forEach(d => d.x+=mid_diff)\n  }\n\n  function mergeSides(parents, children) {\n    parents.forEach(d => {d.is_ancestry = true})\n    parents.forEach(d => d.depth === 1 ? d.parent = children[0] : null)\n\n    return [...children, ...parents.slice(1)];\n  }\n  function nodePositioning({tree, is_vertical}) {\n    tree.forEach(d => {\n      d.y *= (d.is_ancestry ? -1 : 1)\n      if (!is_vertical) {\n        const d_x = d.x; d.x = d.y; d.y = d_x\n      }\n    })\n  }\n\n  function setupSpouses({tree, node_separation}) {\n    for (let i = tree.length; i--;) {\n      const d = tree[i]\n      if (!d.is_ancestry && d.data.rels.spouses && d.data.rels.spouses.length > 0){\n        const side = d.data.data.gender === \"M\" ? -1 : 1;  // female on right\n        d.x += d.data.rels.spouses.length/2*node_separation*side;\n        d.data.rels.spouses.forEach((sp_id, i) => {\n          const spouse = {data: data_stash.find(d0 => d0.id === sp_id), added: true}\n\n          spouse.x = d.x-(node_separation*(i+1))*side;\n          spouse.y = d.y\n          spouse.sx = i > 0 ? spouse.x : spouse.x + (node_separation/2)*side\n          spouse.depth = d.depth;\n          spouse.spouse = d;\n          if (!d.spouses) d.spouses = []\n          d.spouses.push(spouse)\n          tree.push(spouse)\n\n          tree.forEach(d0 => (\n            (d0.data.rels.father === d.data.id && d0.data.rels.mother === spouse.data.id) ||\n            (d0.data.rels.mother === d.data.id && d0.data.rels.father === spouse.data.id)\n            ) ? d0.psx = spouse.sx : null\n          )\n        })\n      }\n      if (d.parents && d.parents.length === 2) {\n        const p1 = d.parents[0],\n          p2 = d.parents[1],\n          midd = p1.x - (p1.x - p2.x)/2,\n          x = (d,sp) => midd + (node_separation/2)*(d.x < sp.x ? 1 : -1)\n\n        p2.x = x(p1, p2); p1.x = x(p2, p1)\n      }\n    }\n  }\n\n  function setupChildrenAndParents({tree}) {\n    tree.forEach(d0 => {\n      delete d0.children\n      tree.forEach(d1 => {\n        if (d1.parent === d0) {\n          if (d1.is_ancestry) {\n            if (!d0.parents) d0.parents = []\n            d0.parents.push(d1)\n          } else {\n            if (!d0.children) d0.children = []\n            d0.children.push(d1)\n          }\n        }\n      })\n    })\n  }\n\n  function calculateTreeDim(tree, node_separation, level_separation, is_vertical) {\n    if (!is_vertical) [node_separation, level_separation] = [level_separation, node_separation]\n    const w_extent = d3.extent(tree, d => d.x),\n      h_extent = d3.extent(tree, d => d.y)\n    return {\n      width: w_extent[1] - w_extent[0]+node_separation, height: h_extent[1] - h_extent[0]+level_separation, x_off: -w_extent[0]+node_separation/2, y_off: -h_extent[0]+level_separation/2\n    }\n  }\n\n  function createRelsToAdd(data) {\n    const to_add_spouses = [];\n    for (let i = 0; i < data.length; i++) {\n      const d = data[i];\n      if (d.rels.children && d.rels.children.length > 0) {\n        if (!d.rels.spouses) d.rels.spouses = []\n        const is_father = d.data.gender === \"M\"\n        let spouse\n\n        d.rels.children.forEach(d0 => {\n          const child = data.find(d1 => d1.id === d0)\n          if (child.rels[is_father ? 'father' : 'mother'] !== d.id) return\n          if (child.rels[!is_father ? 'father' : 'mother']) return\n          if (!spouse) {\n            spouse = createToAddSpouse(d)\n            d.rels.spouses.push(spouse.id)\n          }\n          spouse.rels.children.push(child.id)\n          child.rels[!is_father ? 'father' : 'mother'] = spouse.id\n        })\n      }\n    }\n    to_add_spouses.forEach(d => data.push(d))\n    return data\n\n    function createToAddSpouse(d) {\n      const spouse = createNewPerson({\n        data: {gender: d.data.gender === \"M\" ? \"F\" : \"M\"},\n        rels: {spouses: [d.id], children: []}\n      });\n      spouse.to_add = true;\n      to_add_spouses.push(spouse);\n      return spouse\n    }\n  }\n\n}\n","import d3 from \"../d3.js\"\n\nexport function setupSvg(svg, zoom_polite) {\n  setupZoom()\n\n  function setupZoom() {\n    if (svg.__zoom) return\n    const view = svg.querySelector('.view'),\n      zoom = d3.zoom().on(\"zoom\", zoomed)\n\n    d3.select(svg).call(zoom)\n    svg.__zoomObj = zoom\n\n    if (zoom_polite) zoom.filter(zoomFilter)\n\n    function zoomed(e) {\n      d3.select(view).attr(\"transform\", e.transform);\n    }\n\n    function zoomFilter(e) {\n      if (e.type === \"wheel\" && !e.ctrlKey) return false\n      else if (e.touches && e.touches.length < 2) return false\n      else return true\n    }\n  }\n}\n\nfunction positionTree({t, svg, transition_time=2000}) {\n  const zoom = svg.__zoomObj\n\n  // d3.select(svg).call(zoom.transform, d3.zoomIdentity.translate(x*k, y*k))\n\n  d3.select(svg).transition().duration(transition_time || 0).delay(transition_time ? 100 : 0)  // delay 100 because of weird error of undefined something in d3 zoom\n    .call(zoom.transform, d3.zoomIdentity.scale(t.k).translate(t.x, t.y))\n}\n\nexport function treeFit({svg, svg_dim, tree_dim, with_transition, transition_time}) {\n  const t = calculateTreeFit(svg_dim, tree_dim);\n  positionTree({t, svg, with_transition, transition_time})\n}\n\nexport function calculateTreeFit(svg_dim, tree_dim) {\n  let k = Math.min(svg_dim.width / tree_dim.width, svg_dim.height / tree_dim.height),\n    x = tree_dim.x_off + (svg_dim.width - tree_dim.width*k)/k/2,\n    y = tree_dim.y_off + (svg_dim.height - tree_dim.height*k)/k/2\n\n  if (k>1) {x*=k;y*=k;k=1;}\n  return {k,x,y}\n}\n\nexport function mainToMiddle({datum, svg, svg_dim, scale, transition_time}) {\n  const k = scale || 1, x = svg_dim.width/2-datum.x*k, y = svg_dim.height/2-datum.y,\n    t = {k, x: x/k, y: y/k}\n  positionTree({t, svg, with_transition: true, transition_time})\n}\n","import d3 from \"../../d3.js\";\n\nexport default function Link({d, entering, exiting}) {\n  const path = createPath(d, entering, exiting);\n\n  return {template: (`\n    <path d=\"${path}\" fill=\"none\" stroke=\"#fff\" />\n  `)}\n}\n\nexport function createPath(d, is_) {\n  const line = d3.line().curve(d3.curveMonotoneY),\n    lineCurve = d3.line().curve(d3.curveBasis),\n    path_data = is_ ? d._d() : d.d\n\n  if (!d.curve) return line(path_data)\n  else if (d.curve === true) return lineCurve(path_data)\n}","export function CardBody({d,card_dim,card_display}) {\n  return {template: (`\n    <g class=\"card-body\">\n      <rect width=\"${card_dim.w}\" height=\"${card_dim.h}\" class=\"card-body-rect\" />\n      <g transform=\"translate(${card_dim.text_x}, ${card_dim.text_y})\">\n        <text clip-path=\"url(#card_text_clip)\">\n          <tspan x=\"${0}\" dy=\"${14}\">${card_display[0](d.data)}</tspan>\n          <tspan x=\"${0}\" dy=\"${14}\" font-size=\"14\" font-style = \"italic\">${card_display[1](d.data)}</tspan>\n          <tspan x=\"${0}\" dy=\"${14}\" font-size=\"10\">${card_display[2](d.data)}</tspan>\n        </text>\n        <rect width=\"${card_dim.w-card_dim.text_x-10}\" height=\"${card_dim.h-20}\" style=\"mask: url(#fade)\" class=\"text-overflow-mask\" /> \n      </g>\n    </g>\n  `)\n  }\n}\n\nexport function CardBodyAddNew({d,card_dim,card_add,label}) {\n  return {template: (`\n    <g class=\"card-body ${card_add ? 'card_add' : 'card-unknown'}\">\n      <rect class=\"card-body-rect\" width=\"${card_dim.w}\" height=\"${card_dim.h}\" fill=\"rgb(59, 85, 96)\" />\n      <text transform=\"translate(${card_dim.w/2}, ${card_dim.h/2})\" text-anchor=\"middle\" fill=\"#fff\">\n        <tspan font-size=\"18\" dy=\"${8}\">${label}</tspan>\n      </text>\n    </g>\n  `)\n  }\n}\n\nexport function CardBodyOutline({d,card_dim, is_new}) {\n  return {template: (`\n    <rect width=\"${card_dim.w}\" height=\"${card_dim.h}\" rx=\"4\" ry=\"4\" class=\"card-outline ${(d.data.main && !is_new) ? 'card-main-outline' : ''} ${is_new ? 'card-new-outline' : ''}\" />\n  `)\n  }\n}\n\nexport function PencilIcon({d,card_dim,x,y}) {\n  return ({template: (`\n    <g transform=\"translate(${x || card_dim.w-20},${y || card_dim.h-20})scale(.6)\" style=\"cursor: pointer\" class=\"card_edit pencil_icon\">\n      <circle fill=\"rgba(0,0,0,0)\" r=\"17\" cx=\"8.5\" cy=\"8.5\" />\n      <path fill=\"currentColor\" transform=\"translate(-1.5, -1.5)\"\n         d=\"M19.082,2.123L17.749,0.79c-1.052-1.052-2.766-1.054-3.819,0L1.925,12.794c-0.06,0.06-0.104,0.135-0.127,0.216\n          l-1.778,6.224c-0.05,0.175-0.001,0.363,0.127,0.491c0.095,0.095,0.223,0.146,0.354,0.146c0.046,0,0.092-0.006,0.137-0.02\n          l6.224-1.778c0.082-0.023,0.156-0.066,0.216-0.127L19.082,5.942C20.134,4.89,20.134,3.176,19.082,2.123z M3.076,13.057l9.428-9.428\n          l3.738,3.739l-9.428,9.428L3.076,13.057z M2.566,13.961l3.345,3.344l-4.683,1.339L2.566,13.961z M18.375,5.235L16.95,6.66\n          l-3.738-3.739l1.425-1.425c0.664-0.663,1.741-0.664,2.405,0l1.333,1.333C19.038,3.493,19.038,4.572,18.375,5.235z\"/>\n    </g>\n  `)})\n}\n\nexport function HideIcon({d,card_dim}) {\n  return ({template: (`\n    <g transform=\"translate(${card_dim.w-50},${card_dim.h-20})scale(.035)\" style=\"cursor: pointer\" class=\"card_hide_rels hide_rels_icon\">\n      <circle fill=\"rgba(0,0,0,0)\" r=\"256\" cx=\"256\" cy=\"256\" />\n      <g fill=\"currentColor\">\n        <path d=\"m34,256l26.2,26.2c108,108 283.7,108 391.7,0l26.1-26.2-26.2-26.2c-108-108-283.7-108-391.7,0l-26.1,\n          26.2zm222,126.2c-75.8,0-151.6-28.9-209.3-86.6l-32.9-32.9c-3.7-3.7-3.7-9.7 0-13.5l32.9-32.9c115.4-115.4 303.2-115.4 418.6,\n          0l32.9,32.9c3.7,3.7 3.7,9.7 0,13.5l-32.9,32.9c-57.7,57.7-133.5,86.6-209.3,86.6z\"/>\n        <path d=\"m256,183.5c-40,0-72.5,32.5-72.5,72.5s32.5,72.5 72.5,72.5c40,0 72.5-32.5 72.5-72.5s-32.5-72.5-72.5-72.5zm0,\n          164c-50.5,0-91.5-41.1-91.5-91.5 0-50.5 41.1-91.5 91.5-91.5s91.5,41.1 91.5,91.5c0,50.5-41,91.5-91.5,91.5z\"/>\n      </g>\n    </g>\n  `)})\n}\n\nexport function MiniTree({d,card_dim}) {\n  return ({template: (`\n    <g class=\"card_family_tree\" style=\"cursor: pointer\">\n      <rect x=\"-31\" y=\"-25\" width=\"72\" height=\"15\" fill=\"rgba(0,0,0,0)\"></rect>\n      <g transform=\"translate(${card_dim.w*.8},6)scale(.9)\">\n        <rect x=\"-31\" y=\"-25\" width=\"72\" height=\"15\" fill=\"rgba(0,0,0,0)\"></rect>\n        <line y2=\"-17.5\" stroke=\"#fff\" />\n        <line x1=\"-20\" x2=\"20\" y1=\"-17.5\" y2=\"-17.5\" stroke=\"#fff\" />\n        <rect x=\"-31\" y=\"-25\" width=\"25\" height=\"15\" rx=\"5\" ry=\"5\" class=\"card-male\" />\n        <rect x=\"6\" y=\"-25\" width=\"25\" height=\"15\" rx=\"5\" ry=\"5\" class=\"card-female\" />\n      </g>\n    </g>\n  `)})\n}\n\nexport function PlusIcon({d,card_dim,x,y}) {\n  return ({template: (`\n    <g class=\"card_add_relative\">\n      <g transform=\"translate(${x || card_dim.w/2},${y || card_dim.h})scale(.13)\">\n        <circle r=\"80\" cx=\"40\" cy=\"40\" fill=\"rgba(0,0,0,0)\" />\n        <g transform=\"translate(-10, -8)\">\n          <line\n            x1=\"10\" x2=\"90\" y1=\"50\" y2=\"50\"\n            stroke=\"currentColor\" stroke-width=\"15\" stroke-linecap=\"round\"\n          />\n          <line\n            x1=\"50\" x2=\"50\" y1=\"10\" y2=\"90\"\n            stroke=\"currentColor\" stroke-width=\"15\" stroke-linecap=\"round\"\n          />\n        </g>\n      </g>\n    </g>\n  `)})\n}\n\nexport function InfoIcon({d,card_dim,x,y}) {\n  return ({template: (`\n    <g class=\"card_information\">\n      <g transform=\"translate(${x || card_dim.w/2},${y || card_dim.h})scale(.13)\">\n        <circle r=\"80\" cx=\"40\" cy=\"40\" fill=\"rgba(0,0,0,0)\" />\n        <g transform=\"translate(-10, -8)\">\n          <line\n            x1=\"50\" x2=\"50\" y1=\"30\" y2=\"90\"\n            stroke=\"currentColor\" stroke-width=\"25\"\n          />\n          <line\n            x1=\"50\" x2=\"50\" y1=\"0\" y2=\"5\"\n            stroke=\"currentColor\" stroke-width=\"25\" stroke-linecap=\"round\"\n          />\n        </g>\n      </g>\n    </g>\n  `)})\n}\n\nexport function LinkBreakIcon({x,y,rt,closed}) {\n  return ({template: (`\n    <g style=\"\n          transform: translate(-12.2px, -.5px);\n          cursor: pointer;\n        \" \n        fill=\"currentColor\" class=\"card_break_link${closed ? ' closed' : ''}\"\n      >\n      <g style=\"transform: translate(${x}px,${y}px)scale(.02)rotate(${rt+'deg'})\">\n        <rect width=\"1000\" height=\"700\" y=\"150\" style=\"opacity: 0\" />\n        <g class=\"link_upper\">\n          <g>\n            <path d=\"M616.3,426.4c19,4.5,38.1-7.4,42.6-26.4c4.4-19-7.4-38-26.5-42.5L522.5,332c-18,11.1-53.9,33.4-53.9,33.4l80.4,18.6c-7.8,4.9-19.5,12.1-31.3,19.4L616.3,426.4L616.3,426.4z\"/>\n            <path d=\"M727.4,244.2c-50.2-11.6-100.3,3.3-135.7,35.4c28.6,22.6,64.5,30.2,116.4,51.3l141,32.6c23.9,5.6,56.6,47.2,51.1,71l-4.1,17c-5.6,23.7-47.3,56.4-71.2,51l-143.4-33.2c-66.8-8.6-104.1-16.6-132.9-7.5c17.4,44.9,55.9,80.8,106.5,92.4L800.9,588c81.3,18.8,162.3-31.5,181.2-112.4l4-17c18.8-81.1-31.7-161.8-112.9-180.6L727.4,244.2z\"/>\n          </g>\n        </g>\n        <g class=\"link_lower\">\n          <path d=\"M421.2,384.9l-128,127.6c-13.9,13.8-13.9,36.2,0,50s36.3,13.8,50.2,0.1l136.2-135.8v-36.7l-58.4,58.1V384.9L421.2,384.9z\"/>\n          <path d=\"M204.6,742.8c-17.4,17.3-63.3,17.2-80.6,0.1l-12.3-12.3c-17.3-17.3,0.6-81.2,17.9-98.5l100.2-99.9c12.5-14.9,45.8-40.8,66.1-103.7c-47.7-9.4-98.9,4.2-135.8,40.9L54.2,575c-58.9,58.8-58.9,154,0,212.8L66.6,800c58.9,58.8,154.5,58.8,213.4,0l105.8-105.6c38.4-38.3,51.3-91.9,39.7-141c-44,22.7-89,62.3-116,84.8L204.6,742.8z\"/>\n        </g>\n        <g class=\"link_particles\">\n          <path d=\"M351.9,248.4l-26.5,63.4l80.6,30.1L351.9,248.4z\"/>\n          <path d=\"M529.3,208l-43,26.6l35.4,52.3L529.3,208z\"/>\n          <path d=\"M426.6,158.8l-44-2.9l61.7,134.6L426.6,158.8z\"/>\n        </g>\n      </g>\n    </g>\n  `)})\n}\n\nexport function LinkBreakIconWrapper({d,card_dim}) {\n  let g = \"\",\n    r = d.data.rels, _r = d.data._rels || {},\n    closed = d.data.hide_rels,\n    areParents = r => r.father || r.mother,\n    areChildren = r => r.children && r.children.length > 0\n  if ((d.is_ancestry || d.data.main) && (areParents(r) || areParents(_r))) {g+=LinkBreakIcon({x:card_dim.w/2,y:0, rt: -45, closed}).template}\n  if (!d.is_ancestry && d.added) {\n    const sp = d.spouse, sp_r = sp.data.rels, _sp_r = sp.data._rels || {};\n    if ((areChildren(r) || areChildren(_r)) && (areChildren(sp_r) || areChildren(_sp_r))) {\n      g+=LinkBreakIcon({x:d.sx - d.x + card_dim.w/2 +24.4,y: (d.x !== d.sx ? card_dim.h/2 : card_dim.h)+1, rt: 135, closed}).template\n    }\n  }\n  return g\n}\n\nexport function CardImage({d, image, card_dim, maleIcon, femaleIcon}) {\n  return ({template: (`\n    <g style=\"transform: translate(${card_dim.img_x}px,${card_dim.img_y}px);\" class=\"card_image\" clip-path=\"url(#card_image_clip)\">\n      ${image \n        ? `<image href=\"${process.env.PUBLIC_URL + '/pictures/thumbnails/' + image + \".png\"}\" height=\"${card_dim.img_h}\" width=\"${card_dim.img_w}\" preserveAspectRatio=\"xMidYMin slice\" />`\n        : (d.data.data.gender === \"F\" && !!femaleIcon) ? femaleIcon({card_dim}) \n        : (d.data.data.gender === \"M\" && !!maleIcon) ? maleIcon({card_dim}) \n        : GenderlessIcon()\n      }      \n    </g>\n  `)})\n\n  function GenderlessIcon() {\n    return (`\n      <g class=\"genderless-icon\">\n        <rect height=\"${card_dim.img_h}\" width=\"${card_dim.img_w}\" fill=\"rgb(59, 85, 96)\" />\n        <g transform=\"scale(${card_dim.img_w*0.001616})\">\n         <path transform=\"translate(50,40)\" fill=\"lightgrey\" d=\"M256 288c79.5 0 144-64.5 144-144S335.5 0 256 0 112 \n            64.5 112 144s64.5 144 144 144zm128 32h-55.1c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16H128C57.3 320 0 377.3 \n            0 448v16c0 26.5 21.5 48 48 48h416c26.5 0 48-21.5 48-48v-16c0-70.7-57.3-128-128-128z\" />\n        </g>\n      </g>\n    `)\n  }\n}\n","import {toggleAllRels, toggleRels} from \"../CalculateTree/CalculateTree.handlers.js\"\n//import AddRelativeTree from \"../AddRelativeTree/AddRelativeTree.js\"\nimport {deletePerson, moveToAddToAdded} from \"./general.js\"\n\nexport function cardChangeMain(store, {card, d}) {\n  toggleAllRels(store.getTree().data, false)\n  store.update.mainId(d.data.id)\n  store.update.tree({tree_position: 'inherit'})\n  return true\n}\n\nexport function cardEdit(store, {card, d, cardEditForm}) {\n  const datum = d.data,\n    postSubmit = (props) => {\n      if (datum.to_add) moveToAddToAdded(datum, store.getData())\n      if (props && props.delete) {\n        if (datum.main) store.update.mainId(null)\n        deletePerson(datum, store.getData())\n      }\n      store.update.tree()\n    }\n  cardEditForm({datum, postSubmit, store})\n}\n\nexport function cardShowHideRels(store, {card, d}) {\n  d.data.hide_rels = !d.data.hide_rels\n  toggleRels(d, d.data.hide_rels)\n  store.update.tree({tree_position: 'inherit'})\n}","import {\n  CardBody,\n  CardBodyAddNew,\n  CardBodyOutline,\n  CardImage,\n  LinkBreakIconWrapper,\n  MiniTree, PencilIcon,\n  PlusIcon, InfoIcon\n} from \"./Card.Elements.js\"\nimport {cardChangeMain, cardEdit, cardShowHideRels} from \"../../handlers/cardMethods.js\"\nimport {isAllRelativeDisplayed} from \"../../handlers/general.js\"\n\nexport function Card(props) {\n  props = setupProps(props);\n  const store = props.store;\n  setupSvgDefs()\n\n  return function ({node, d}) {\n    const el = document.createElementNS(\"http://www.w3.org/2000/svg\", 'g'),\n      gender_class = d.data.data.gender === 'M' ? 'card-male' : d.data.data.gender === 'F' ? 'card-female' : 'card-genderless',\n      card_dim = props.card_dim,\n      show_mini_tree = !isAllRelativeDisplayed(d, store.state.tree.data),\n      unknown_lbl = props.cardEditForm ? 'ADD' : 'UNKNOWN',\n\n      mini_tree = () => !d.data.to_add && show_mini_tree ? MiniTree({d,card_dim}).template : '',\n      card_body_outline = () => CardBodyOutline({d,card_dim,is_new:d.data.to_add}).template,\n      card_body = () => !d.data.to_add ? CardBody({d,card_dim, card_display: props.card_display}).template : CardBodyAddNew({d,card_dim, card_add: props.cardEditForm, label: unknown_lbl}).template,\n      card_image = () => !d.data.to_add ? CardImage({d, image: d.data.data.avatar || null, card_dim, maleIcon: null, femaleIcon: null}).template : '',\n      edit_icon = () => !d.data.to_add && props.cardEditForm ? PencilIcon({card_dim, x: card_dim.w-46, y: card_dim.h-20}).template : '',\n      add_icon = () => !d.data.to_add && props.cardEditForm ? PlusIcon({card_dim, x: card_dim.w-26, y: card_dim.h-20}).template : '',\n      info_icon = () => !d.data.to_add && props.infoLink ? InfoIcon({card_dim, x: card_dim.w-26, y: card_dim.h-20}).template : '',\n      link_break_icon = () => LinkBreakIconWrapper({d,card_dim})\n\n    el.innerHTML = (`\n      <g class=\"card ${gender_class}\" data-id=\"${d.data.id}\" data-cy=\"card\">\n        <g transform=\"translate(${-card_dim.w / 2}, ${-card_dim.h / 2})\">\n          ${props.mini_tree ? mini_tree() : ''}\n          ${card_body_outline()}\n          <g clip-path=\"url(#card_clip)\">\n            ${card_body()}\n            ${card_image()}\n            ${edit_icon()}\n            ${add_icon()}\n            ${info_icon()}\n          </g>\n          ${props.link_break ? link_break_icon() : ''}\n        </g>\n      </g>\n    `)\n    setupListeners(el, d, store);\n\n    return el\n  }\n\n  function setupListeners(el, d, store) {\n    let p;\n\n    p = el.querySelector(\".card\")\n    if (p) p.addEventListener(\"click\", (e) => {e.stopPropagation();cardChangeMain(store, {card:el, d})})\n\n    p = el.querySelector(\".card_edit\")\n    if (p && props.cardEditForm) p.addEventListener(\"click\", (e) => {e.stopPropagation();cardEdit(store, {card:el, d, cardEditForm: props.cardEditForm})})\n\n    p = el.querySelector(\".card_add\")\n    if (p && props.cardEditForm) p.addEventListener(\"click\", (e) => {e.stopPropagation();cardEdit(store, {card:el, d, cardEditForm: props.cardEditForm})})\n\n    p = el.querySelector(\".card_add_relative\")\n    if (p) p.addEventListener(\"click\", (e) => {e.stopPropagation();props.addRelative({d})})\n\n    p = el.querySelector(\".card_information\")\n    if (p) p.addEventListener(\"click\", (e) => {e.stopPropagation();window.open(process.env.PUBLIC_URL + \"#/person?id=\" + d.data.id, \"_blank\");})\n\n    p = el.querySelector(\".card_family_tree\")\n    if (p) p.addEventListener(\"click\", (e) => {e.stopPropagation();cardChangeMain(store, {card:el, d})})\n\n    p = el.querySelector(\".card_break_link\")\n    if (p) p.addEventListener(\"click\", (e) => {e.stopPropagation();cardShowHideRels(store, {card:el, d})})\n  }\n\n  function setupSvgDefs() {\n    if (props.svg.querySelector(\"defs#f3CardDef\")) return\n    const card_dim = props.card_dim\n    props.svg.insertAdjacentHTML('afterbegin', (`\n      <defs id=\"f3CardDef\">\n        <linearGradient id=\"fadeGrad\">\n          <stop offset=\"0.9\" stop-color=\"white\" stop-opacity=\"0\"/>\n          <stop offset=\".91\" stop-color=\"white\" stop-opacity=\".5\"/>\n          <stop offset=\"1\" stop-color=\"white\" stop-opacity=\"1\"/>\n        </linearGradient>\n        <mask id=\"fade\" maskContentUnits=\"objectBoundingBox\"><rect width=\"1\" height=\"1\" fill=\"url(#fadeGrad)\"/></mask>\n        <clipPath id=\"card_clip\"><path d=\"${curvedRectPath({w:card_dim.w, h:card_dim.h}, 5)}\"></clipPath>\n        <clipPath id=\"card_text_clip\"><rect width=\"${card_dim.w-card_dim.text_x-10}\" height=\"${card_dim.h-10}\"></rect></clipPath>\n        <clipPath id=\"card_image_clip\"><path d=\"M0,0 Q 0,0 0,0 H${card_dim.img_w} V${card_dim.img_h} H0 Q 0,${card_dim.img_h} 0,${card_dim.img_h} z\"></clipPath>\n        <clipPath id=\"card_image_clip_curved\"><path d=\"${curvedRectPath({w: card_dim.img_w, h:card_dim.img_h}, 5, ['rx', 'ry'])}\"></clipPath>\n      </defs>\n    `))\n\n    function curvedRectPath(dim, curve, no_curve_corners) {\n      const {w,h} = dim,\n        c = curve,\n        ncc = no_curve_corners || [],\n        ncc_check = (corner) => ncc.includes(corner),\n        lx = ncc_check('lx') ? `M0,0` : `M0,${c} Q 0,0 5,0`,\n        rx = ncc_check('rx') ? `H${w}` : `H${w-c} Q ${w},0 ${w},5`,\n        ry = ncc_check('ry') ? `V${h}` : `V${h-c} Q ${w},${h} ${w-c},${h}`,\n        ly = ncc_check('ly') ? `H0` : `H${c} Q 0,${h} 0,${h-c}`\n\n      return (`${lx} ${rx} ${ry} ${ly} z`)\n    }\n  }\n\n  function setupProps(props) {\n    const default_props = {\n      mini_tree: true,\n      link_break: true,\n      card_dim: {w:220,h:70,text_x:75,text_y:15,img_w:60,img_h:60,img_x:5,img_y:5}\n    }\n    if (!props) props = {}\n    for (const k in default_props) {\n      if (typeof props[k] === 'undefined') props[k] = default_props[k]\n    }\n    return props\n  }\n}\n","export default function CalculateTree({datum, data_stash, card_dim, labels}) {\n  const sx = card_dim.w+40, y = card_dim.h+50,\n    lbls = labels || {}\n  datum = datum ? datum : {id: \"0\", data: {fn: \"FN\", ln: \"LN\", gender: \"M\"}}\n  const data = [\n    {x: 0, y: 0, data: datum},\n    {x: -100, y: -y, data: {rel_type: 'father', data: {label: lbls.father || \"Add father\", gender: \"M\"}}},\n    {x: 100, y: -y, data: {rel_type: 'mother', data: {label: lbls.mother || \"Add mother\", gender: \"F\"}}},\n\n    {x: sx, y: 0, data: {rel_type: 'spouse', data: {label: lbls.spouse || \"Add spouse\", gender: \"F\"}}},\n\n    {x: -100, y: y, data: {rel_type: 'son', data: {label: lbls.son || \"Add son\", gender: \"M\"}}},\n    {x: 100, y: y, data: {rel_type: 'daughter', data: {label: lbls.daughter || \"Add daughter\", gender: \"F\"}}},\n  ].filter(d => shouldAddRel(d.data.rel_type))\n\n  function shouldAddRel(rel_type) {\n    if (rel_type === 'father') return !datum.rels.father || data_stash.find(d => d.id === datum.rels.father).to_add\n    else if (rel_type === 'mother') return !datum.rels.mother || data_stash.find(d => d.id === datum.rels.mother).to_add\n    else return true\n  }\n\n  return {data}\n}\n","import {\n  addNewPerson,\n  createNewPersonWithGenderFromRel,\n  handleRelsOfNewDatum,\n} from \"../handlers/newPerson.js\"\n\nexport default function View(tree, {store, data_stash, cont, datum, card_dim, cardEditForm, scale}) {\n  const svg_dim = cont.getBoundingClientRect(),\n    tree_fit = calculateTreeFit(svg_dim),\n    mounted = (node) => {\n      addEventListeners(node)\n    }\n\n  return {\n    template: (`\n      <svg id=\"family-tree-svg\" style=\"width: 100%; height: 100%\">\n        <rect width=\"${svg_dim.width}\" height=\"${svg_dim.height}\" fill=\"transparent\" />\n        <g class=\"view\">\n          <g transform=\"translate(${tree_fit.x}, ${tree_fit.y})scale(${tree_fit.k})\">\n            ${tree.data.slice(1).map((d, i) => Link({d, is_vertical: ![\"spouse\"].includes(d.data.rel_type)}).template)}\n            ${tree.data.slice(1).map((d, i) => Card({d}).template)}\n          </g>\n        </g>\n      </svg>\n    `),\n    mounted\n  }\n\n  function calculateTreeFit(svg_dim) {\n    const k = scale || 1;\n    return {k, x:svg_dim.width/2, y: svg_dim.height/2}\n  }\n\n  function Card({d, is_main}) {\n    const [w, h] = is_main ? [160, 60] : [160, 40],\n      pos = {x: d.x, y: d.y}\n\n    return {template: (`\n      <g transform=\"translate(${pos.x}, ${pos.y})\" class=\"card\" data-rel_type=\"${d.data.rel_type}\" style=\"cursor: pointer\">\n        <g transform=\"translate(${-w / 2}, ${-h / 2})\">\n          ${CardBody({d,w,h}).template}\n        </g>\n      </g>\n    `)\n    }\n\n    function CardBody({d,w,h}) {\n      const color_class = d.data.data.gender === 'M' ? 'card-male' : d.data.data.gender === 'F' ? 'card-female' : 'card-genderless'\n      return {template: (`\n        <g>\n          <rect width=\"${w}\" height=\"${h}\" fill=\"#fff\" rx=\"${10}\" ${d.data.main ? 'stroke=\"#000\"' : ''} class=\"${color_class}\" />\n          <text transform=\"translate(${0}, ${h / 4})\">\n            <tspan x=\"${10}\" dy=\"${14}\">${d.data.data.label}</tspan>\n          </text>\n        </g>\n      `)\n      }\n    }\n  }\n\n  function Link({d, is_vertical}) {\n    return {template: (`\n      <path d=\"${createPath(d)}\" fill=\"none\" stroke=\"#fff\" />\n    `)}\n\n    function createPath() {\n      const {w,h} = card_dim;\n      let parent = (is_vertical && d.y < 0)\n        ? {x: 0, y: -h/2}\n        : (is_vertical && d.y > 0)\n        ? {x: 0, y: h/2}\n        : (!is_vertical && d.x < 0)\n        ? {x: -w/2, y: 0}\n        : (!is_vertical && d.x > 0)\n        ? {x: w/2, y: 0}\n        : {x: 0, y: 0}\n\n\n      if (is_vertical) {\n        return (\n          \"M\" + d.x + \",\" + d.y\n          + \"C\" + (d.x) + \",\" + (d.y + (d.y < 0 ? 50 : -50))\n          + \" \" + (parent.x) + \",\" + (parent.y + (d.y < 0 ? -50 : 50))\n          + \" \" + parent.x + \",\" + parent.y\n        )\n      } else {\n        const s = d.x > 0 ? +1 : -1;\n        return (\n          \"M\" + d.x + \",\" + d.y\n          + \"C\" + (parent.x + 50*s) + \",\" + d.y\n          + \" \" + (parent.x + 150*s) + \",\" + parent.y\n          + \" \" + parent.x + \",\" + parent.y\n        )\n      }\n    }\n  }\n\n  function addEventListeners(view) {\n    view.addEventListener(\"click\", e => {\n      const node = e.target\n      handleCardClick(node) || view.remove()\n    })\n\n    function handleCardClick(node) {\n      if (!node.closest('.card')) return\n      const card = node.closest('.card'),\n        rel_type = card.getAttribute(\"data-rel_type\"),\n        rel_datum = datum,\n        new_datum = createNewPersonWithGenderFromRel({rel_datum, rel_type}),\n        postSubmit = () => {\n          view.remove();\n          addNewPerson({data_stash, datum: new_datum})\n          handleRelsOfNewDatum({datum: new_datum, data_stash, rel_datum, rel_type})\n          store.update.tree();\n        }\n      cardEditForm({datum: new_datum, rel_datum, rel_type, postSubmit, store})\n      return true\n    }\n  }\n\n}\n","import {toggleAllRels} from \"../CalculateTree/CalculateTree.handlers.js\"\nimport AddRelativeTree from \"./AddRelativeTree.js\"\n\nexport function AddRelative({store, cont, card_dim, cardEditForm, labels}) {\n  return function ({d, scale}) {\n    const transition_time = 1000\n\n    if (!scale && window.innerWidth < 650) scale = window.innerWidth / 650\n    toggleAllRels(store.getTree().data, false)\n    store.update.mainId(d.data.id);\n    store.update.tree({tree_position: 'main_to_middle', transition_time, scale})\n    const props = {\n      store,\n      data_stash: store.getData(),\n      cont,\n      datum: d.data,\n      transition_time,\n      scale,\n      card_dim,\n      cardEditForm,\n      labels\n    }\n    AddRelativeTree(props)\n  }\n}\n","import d3 from \"../d3.js\"\nimport CalculateTree from \"./AddRelativeTree.CalculateTree.js\"\nimport View from \"./AddRelativeTree.View.js\"\n\nexport default function AddRelativeTree(props) {\n  const tree = CalculateTree(props),\n    view = View(tree, props)\n\n  const div_add_relative = document.createElement(\"div\")\n  div_add_relative.style.cssText = \"width: 100%; height: 100%; position: absolute; top: 0; left: 0;background-color: rgba(0,0,0,.3);opacity: 0\"\n  div_add_relative.innerHTML = view.template\n\n  props.cont.appendChild(div_add_relative)\n  view.mounted(div_add_relative)\n  d3.select(div_add_relative).transition().duration(props.transition_time).delay(props.transition_time/4).style(\"opacity\", 1)\n}\n","import CalculateTree from \"./CalculateTree/CalculateTree.js\"\nimport d3AnimationView from \"./view/View.d3Animation.js\"\nimport createStore from \"./createStore.js\"\nimport * as handlers from './handlers.js'\nimport * as elements from './elements.js'\n\nexport default {\n  CalculateTree,\n  createStore,\n  d3AnimationView,\n  handlers,\n  elements\n}","import CalculateTree from \"./CalculateTree/CalculateTree.js\"\n//import {createTreeDataWithMainNode} from \"./handlers/newPerson.js\"\n\nexport default function createStore(initial_state) {\n  let onUpdate;\n  const state = initial_state,\n    update = {\n      tree: (props) => {\n        state.tree = calcTree();\n        if (onUpdate) onUpdate(props)\n      },\n      mainId: main_id => state.main_id = main_id,\n      data: data => state.data = data\n    },\n    getData = () => state.data,\n    getTree = () => state.tree,\n    setOnUpdate = (f) => onUpdate = f,\n    methods = {}\n\n  return {state, update, getData, getTree, setOnUpdate, methods}\n\n\n  function calcTree() {\n    return CalculateTree({\n      data_stash: state.data, main_id: state.main_id,\n      node_separation: state.node_separation, level_separation: state.level_separation\n    })\n  }\n}","import d3 from \"../d3.js\"\n\nimport {mainToMiddle, setupSvg, treeFit} from \"./View.handlers.js\"\nimport {createPath} from \"./elements/Link.js\"\nimport {createLinks} from \"../CalculateTree/createLinks.js\"\nimport {Card as CardDefault} from \"./elements/Card.js\"\nimport {calculateEnterAndExitPositions} from \"../CalculateTree/CalculateTree.handlers.js\"\n\nexport default function d3AnimationView({store, cont, Card}) {\n  const svg = createSvg();\n  setupSvg(svg, store.state.zoom_polite);\n\n  return {update: updateView, svg, setCard: card => Card = card}\n\n  function updateView(props) {\n    if (!props) props = {}\n    const tree = store.state.tree,\n      view = d3.select(svg).select(\".view\"),\n      tree_position = document.getElementById('fit_view').checked ? 'fit' : 'inherit',\n      transition_time = props.hasOwnProperty('transition_time') ? props.transition_time : 1000;\n    \n    updateCards();\n    updateLinks();\n    if (props.initial) treeFit({svg, svg_dim: svg.getBoundingClientRect(), tree_dim: tree.dim, transition_time: 0})\n    else if (tree_position === 'fit') treeFit({svg, svg_dim: svg.getBoundingClientRect(), tree_dim: tree.dim, transition_time})\n    else if (tree_position === 'main_to_middle') mainToMiddle({datum: tree.data[0], svg, svg_dim: svg.getBoundingClientRect(), scale: props.scale, transition_time})\n    else if (tree_position === 'inherit') {}\n\n    return true\n\n    function updateLinks() {\n      const links_data = tree.data.reduce((acc, d) => acc.concat(createLinks({d, tree:tree.data})), []),\n        link = view.select(\".links_view\").selectAll(\"path.link\").data(links_data, d => d.id),\n        link_exit = link.exit(),\n        link_enter = link.enter().append(\"path\").attr(\"class\", \"link\"),\n        link_update = link_enter.merge(link)\n\n      link_exit.each(linkExit)\n      link_enter.each(linkEnter)\n      link_update.each(linkUpdate)\n\n      function linkEnter(d) {\n        d3.select(this).attr(\"fill\", \"none\").attr(\"stroke\", \"rgb(0, 0, 0)\").style(\"opacity\", 0)\n          .attr(\"d\", createPath(d, true))\n      }\n\n      function linkUpdate(d) {\n        const path = d3.select(this);\n        const delay = calculateDelay(d)\n        path.transition('path').duration(transition_time).delay(delay).attr(\"d\", createPath(d)).style(\"opacity\", 1)\n      }\n\n      function linkExit(d) {\n        const path = d3.select(this);\n        path.transition('op').duration(800).style(\"opacity\", 0)\n        path.transition('path').duration(transition_time).attr(\"d\", createPath(d, true))\n          .on(\"end\", () => path.remove())\n      }\n\n    }\n\n    function updateCards() {\n      const card = view.select(\".cards_view\").selectAll(\"g.card_cont\").data(tree.data, d => d.data.id),\n        card_exit = card.exit(),\n        card_enter = card.enter().append(\"g\").attr(\"class\", \"card_cont\"),\n        card_update = card_enter.merge(card)\n\n      card_exit.each(d => calculateEnterAndExitPositions(d, false, true))\n      card_enter.each(d => calculateEnterAndExitPositions(d, true, false))\n\n      card_exit.each(cardExit)\n      card.each(cardUpdateNoEnter)\n      card_enter.each(cardEnter)\n      card_update.each(cardUpdate)\n\n      function cardEnter(d) {\n        d3.select(this)\n          .attr(\"transform\", `translate(${d._x}, ${d._y})`)\n          .style(\"opacity\", 0)\n          .node().appendChild(CardElement(this, d))\n      }\n\n      function cardUpdateNoEnter(d) {}\n\n      function cardUpdate(d) {\n        this.innerHTML = \"\"\n        this.appendChild(CardElement(this, d))\n        const delay = calculateDelay(d);\n        d3.select(this).transition().duration(transition_time).delay(delay).attr(\"transform\", `translate(${d.x}, ${d.y})`).style(\"opacity\", 1)\n      }\n\n      function cardExit(d) {\n        const g = d3.select(this)\n        g.transition().duration(transition_time).style(\"opacity\", 0).attr(\"transform\", `translate(${d._x}, ${d._y})`)\n          .on(\"end\", () => g.remove())\n      }\n\n      function CardElement(node, d) {\n        if (Card) return Card({node, d})\n        else return CardDefault({store, svg})({node, d})\n      }\n    }\n\n    function calculateDelay(d) {\n      if (!props.initial) return 0\n      const delay_level = 100,\n        ancestry_levels = Math.max(...tree.data.map(d=>d.is_ancestry ? d.depth : 0))\n      let delay = d.depth*delay_level;\n      if ((d.depth !== 0 || !!d.spouse) && !d.is_ancestry) {\n        delay+=(ancestry_levels)*delay_level  // after ancestry\n        if (d.spouse) delay+=delay_level  // spouse after bloodline\n        delay+=(d.depth)*delay_level  // double the delay for each level because of additional spouse delay\n      }\n      return delay\n    }\n\n  }\n\n  function createSvg() {\n    const svg_dim = cont.getBoundingClientRect(),\n      svg_html = (`\n        <svg class=\"main_svg\">\n          <rect width=\"${svg_dim.width}\" height=\"${svg_dim.height}\" fill=\"white\" />\n          <g class=\"view\">\n            <g class=\"links_view\"></g>\n            <g class=\"cards_view\"></g>\n          </g>\n          <g style=\"transform: translate(100%, 100%)\">\n            <g class=\"fit_screen_icon cursor-pointer\" style=\"transform: translate(-50px, -50px); display: none\">\n              <rect width=\"27\" height=\"27\" stroke-dasharray=\"${27/2}\" stroke-dashoffset=\"${27/4}\" \n                style=\"stroke:#fff;stroke-width:4px;fill:transparent;\"/>\n              <circle r=\"5\" cx=\"${27/2}\" cy=\"${27/2}\" style=\"fill:#fff\" />          \n            </g>\n          </g>\n        </svg>\n      `)\n    const fake_cont = document.createElement(\"div\")\n    fake_cont.innerHTML = svg_html\n    const svg = fake_cont.firstElementChild\n    cont.innerHTML = \"\"\n    cont.appendChild(svg)\n\n    return svg\n  }\n}","export function createLinks({d, tree, is_vertical}) {\n  const links = [];\n\n  if (d.data.rels.spouses && d.data.rels.spouses.length > 0) handleSpouse({d})\n  handleAncestrySide({d})\n  handleProgenySide({d})\n\n  return links;\n\n  function handleAncestrySide({d}) {\n    if (!d.parents || d.parents.length !== 2) return\n    const p1 = d.parents[0], p2 = d.parents[1]\n\n    const p = {x: getMid(p1, p2, 'x'), y: getMid(p1, p2, 'y')}\n\n    links.push({\n      d: Link(d, p),\n      _d: () => {\n        const _d = {x: d.x, y: d.y},\n          _p = {x: d.x, y: d.y}\n        return Link(_d, _p)\n      },\n      curve: true, id: linkId(d, d.parents[0], d.parents[1]), depth: d.depth+1, is_ancestry: true\n    })\n  }\n\n\n  function handleProgenySide({d}) {\n    if (!d.children || d.children.length === 0) return\n\n    d.children.forEach((child, i) => {\n      const other_parent = otherParent(child, d, tree),\n        sx = other_parent.sx\n\n      links.push({\n        d: Link(child, {x: sx, y: d.y}),\n        _d: () => Link({x: sx, y: d.y}, {x: _or(child, 'x'), y: _or(child, 'y')}),\n        curve: true, id: linkId(child, d, other_parent), depth: d.depth+1\n      })\n    })\n  }\n\n\n  function handleSpouse({d}) {\n    d.data.rels.spouses.forEach(sp_id => {\n      const spouse = tree.find(d0 => d0.data.id === sp_id);\n      if (!spouse || d.spouse) return\n      links.push({\n        d: [[d.x, d.y], [spouse.x, spouse.y]],\n        _d: () => [\n          d.is_ancestry ? [_or(d, 'x')-.0001, _or(d, 'y')] : [d.x, d.y], // add -.0001 to line to have some length if d.x === spouse.x\n          d.is_ancestry ? [_or(spouse, 'x', true), _or(spouse, 'y')] : [d.x-.0001, d.y]\n        ],\n        curve: false, id: [d.data.id, spouse.data.id].join(\", \"), depth: d.depth, spouse: true, is_ancestry: spouse.is_ancestry\n      })\n    })\n  }\n\n  ///\n  function getMid(d1, d2, side, is_) {\n    if (is_) return _or(d1, side) - (_or(d1, side) - _or(d2, side))/2\n    else return d1[side] - (d1[side] - d2[side])/2\n  }\n\n  function _or(d, k) {\n   return d.hasOwnProperty('_'+k) ? d['_'+k] : d[k]\n  }\n\n  function Link(d, p) {\n    const hy = (d.y + (p.y - d.y) / 2)\n    return [\n      [d.x, d.y],\n      [d.x, hy],\n      [d.x, hy],\n      [p.x, hy],\n      [p.x, hy],\n      [p.x, p.y],\n    ]\n  }\n\n  function linkId(...args) {\n    return args.map(d => d.data.id).sort().join(\", \")  // make unique id\n  }\n\n  function otherParent(d, p1, data) {\n    return data.find(d0 => (d0.data.id !== p1.data.id) && ((d0.data.id === d.data.rels.mother) || (d0.data.id === d.data.rels.father)))\n  }\n}\n\n\n\n\n","import React from 'react';\nimport f3 from \"./family-chart/index.js\"; // npm i family-chart\nimport \"./family-chart.css\"; // create file 'family-chart.css' in same directory, copy/paste css from examples/create-tree\nimport treeJsonData from './json/family_tree.json'\nimport Select from 'react-select'\n\nexport default class FamilyTree extends React.Component {\n  cont = React.createRef();\n\n  constructor(props) {\n    super(props)\n    this.state ={\n      store: null,\n      view: null\n    }\n  }\n\n  componentDidMount() {\n    if (!this.cont.current) return;\n\n    const store = f3.createStore({\n        main_id: this.props.person_id ? this.props.person_id : \"0\",\n        data: treeJsonData,\n        node_separation: 250,\n        level_separation: 110\n      }),\n      view = f3.d3AnimationView({\n        store,\n        cont: document.querySelector(\"#FamilyChart\")\n      }),\n      Card = f3.elements.Card({\n        store,\n        svg: view.svg,\n        card_dim: {\n          w: 220,\n          h: 70,\n          text_x: 75,\n          text_y: 15,\n          img_w: 60,\n          img_h: 60,\n          img_x: 5,\n          img_y: 5\n        },\n        card_display: [\n          (d) => `${d.data[\"first name\"] || \"?\"} ${d.data[\"last name\"] || \"?\"}`,\n          (function (d) { if (d.data[\"nee\"]){\n            return \"nee \" + d.data[\"nee\"];\n          }\n          else {\n            return \"\";\n          }\n          }),\n          (d) => `${d.data[\"birthday\"] || \"\"}`\n        ],\n        mini_tree: true,\n        link_break: false,\n        infoLink: true,\n      });\n\n    view.setCard(Card);\n    store.setOnUpdate((props) => view.update(props || {}));\n    store.update.tree({ initial: true });\n    \n    this.setState({ store: store, view: view });\n  }\n\n  updateTree = (selectedOptions) => {\n    let store = {...this.state.store};\n    store.state.main_id = selectedOptions.value;\n    this.setState({ store: store });\n\n    this.state.store.update.tree();\n  }\n  \n  \n  render() {\n    var styles = {\n      options: {\n        float: \"left\",\n        width: \"20%\"\n      },\n      tree: {\n        float: \"left\"\n      }\n    };\n\n    const people_options = treeJsonData.map((person) => ({\n      value: person['id'],\n      label: `${(person[\"data\"][\"first name\"] || \"?\") + \" \"}\\\n              ${person[\"data\"][\"nickname\"] ? '\"' + person[\"data\"][\"nickname\"] + '\" ' : \"\"}\\\n              ${person[\"data\"][\"last name\"] || \"?\"}`\n    }));\n\n    return (\n    <>\n      <div style={styles.options}>\n        <br/>\n        <div>\n          <input type=\"checkbox\" id=\"fit_view\" name=\"fit_view\" defaultChecked />\n          <label htmlFor=\"fit_view\">Auto-resize Tree</label>\n        </div>\n        <br/>\n        <div ref={this.cont}>\n          <label>Find Person</label>\n          <br/>\n          <Select options={people_options} onChange={this.updateTree} />\n        </div>\n      </div>\n      <div style={styles.tree}>\n        <br/>\n        <div className=\"f3\" id=\"FamilyChart\" ref={this.cont}></div>\n      </div>\n    </>\n    );\n  }\n}\n","import React from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport FamilyChart from \"../src/FamilyChart\";\n  \nconst FamilyTree = () => {\n  const [searchParams] = useSearchParams();\n  var person_id = searchParams.get('id');\n\n  return (\n      <div className=\"App\">\n        <FamilyChart person_id={person_id} />\n      </div>\n    );\n};\n  \nexport default FamilyTree;","import React, { useMemo } from \"react\";\nimport { useTable } from \"react-table\";\nimport pictureJsonData from '../src/json/picture_index.json'\n\nfunction processData(jsonData) {\n  const result = Object.keys(jsonData).map((key) => { \n    return jsonData[key];\n  });\n  return result;\n}\n\nconst Names = ({ row }) => {\n  var id_list = row.original.people;\n  \n  return (\n    <div style={{whiteSpace: \"pre-line\"}}>\n      {row.original.names.map( (current_row, index) =>\n        <div key={row.original.filename + \"_\" + index.toString()}>\n          {current_row.map( ( current_person, index2)=>\n            <span key={row.original.filename + \"_\" + index.toString() + \"_\" + index2.toString()}>\n              <a href={process.env.PUBLIC_URL + '#/person?id=' + id_list[index][index2]}>{current_person}</a>\n              {index2 + 1 < id_list[index].length ? \", \" : \"\"}\n            </span>\n          )}\n        </div>\n         )}\n    </div>\n  );\n};\n\nexport default function Pictures() {\n    const columns = useMemo(\n        () => [\n          {\n            Header: \"Filename\",\n            accessor: d => <a href = {process.env.PUBLIC_URL + '#/picture?name=' + d.filename}>{d.filename}</a>\n          },\n          {\n            Header: \"Date (Y/M/D)\",\n            accessor: d => `${d.date.year || \"?\"}/${d.date.month || \"?\"}/${d.date.day || \"?\"}`\n          },\n          {\n            Header: \"Location\",\n            accessor: \"location\"\n          },\n          {\n            Header: \"People\",\n            Cell: ({ row }) => <Names row={row} />\n          },\n          {\n            Header: \"Additional Information\",\n            accessor: \"additional info\"\n          },\n        ],\n        []\n      );\n\n\n      const [search, setSearch] = React.useState('');\n\n      const handleSearch = (event) => {\n        setSearch(event.target.value);\n      };\n\n      const processedPictureJsonData = processData(pictureJsonData);\n      // const data = React.useMemo(() => processedPictureJsonData, []);\n      const data = React.useMemo(\n        () =>\n          processedPictureJsonData.filter((picture) => {\n            return picture.names.join().toLowerCase().includes(search.toLowerCase());\n          }),\n        [search, processedPictureJsonData]\n      );\n    \n\n      const {\n        getTableProps, // table props from react-table\n        getTableBodyProps, // table body props from react-table\n        headerGroups, // headerGroups, if your table has groupings\n        rows, // rows for the table based on the data passed\n        prepareRow // Prepare the row (this function needs to be called for each row before getting the row props)\n      } = useTable({\n        columns,\n        data\n      });\n\n    \n      return (\n        <>\n        <style>{`\n          table, th, td {\n            border: 1px solid black;\n            border-collapse: collapse;\n            padding: 5px;\n          }\n        `}</style>\n\n          <label style={{margin: \"20px 0px 20px 0px\", display: \"inline-block\"}} htmlFor=\"search\">\n            Search People:{' '}\n            <input id=\"search\" type=\"text\" onChange={handleSearch} />\n          </label>\n          <table {...getTableProps()}>\n            <thead>\n              {headerGroups.map(headerGroup => (\n                <tr {...headerGroup.getHeaderGroupProps()}>\n                  {headerGroup.headers.map(column => (\n                    <th {...column.getHeaderProps()}>{column.render(\"Header\")}</th>\n                  ))}\n                </tr>\n              ))}\n            </thead>\n            <tbody {...getTableBodyProps()}>\n              {rows.map((row, i) => {\n                prepareRow(row);\n                return (\n                  <tr {...row.getRowProps()}>\n                    {row.cells.map(cell => {\n                      return <td {...cell.getCellProps()}>{cell.render(\"Cell\")}</td>;\n                    })}\n                  </tr>\n                );\n              })}\n            </tbody>\n          </table>\n        </>\n      );\n};","import React, { useMemo, useState } from \"react\";\nimport pictureJsonData from '../src/json/picture_index.json'\nimport { useSearchParams, Link } from 'react-router-dom';\n\n//take in json object of picture data, output array of [[category name, string information], ...] for each applicable category\nfunction formatPictureInformation(data){\n  var information_list = [];\n\n  //People\n  var people_string = \n  <div style={{whiteSpace: \"pre-line\"}}>\n    {data.names.map( (current_row, index) =>\n      <div key={data.filename + \"_\" + index.toString()}>\n        {current_row.map( ( current_person, index2)=>\n          <span key={data.filename + \"_\" + index.toString() + \"_\" + index2.toString()}>\n            <a href={process.env.PUBLIC_URL + '#/person?id=' + data.people[index][index2]}>{current_person}</a>\n            {index2 + 1 < data.people[index].length ? \", \" : \"\"}\n          </span>\n        )}\n      </div>\n      )}\n  </div>;\n\n  if (people_string !== \"\"){\n      information_list.push([\"People (Left to Right)\", people_string]);\n  }\n\n  //Date\n  var year = data.date.year;\n  var month = data.date.month;\n  var day = data.date.day;\n  var date_string = (year || \"?\") + \"/\" + (month || \"?\") + \"/\" + (day || \"?\");\n\n  if (date_string !== \"?/?/?\"){\n      information_list.push([\"Date (Y/M/D)\", date_string]);\n  }\n\n  //Location\n  if (data.location !== null){\n      information_list.push([\"Location\", data.location]);\n  }\n  \n  //Additional Info\n  if (data[\"additional info\"] !== null){\n      information_list.push([\"Additional Information\", data[\"additional info\"]]);\n  }\n\n  return information_list;\n}\n\nasync function formatPictureLabels(image_labels_loc, pictureData){\n  const label_data_text = await (await fetch(image_labels_loc)).text();\n  \n    //loop through the labels to pull out the people locations\n    var label_array = [];\n    var label_centroids_x = [];\n    var label_centroids_y = [];\n    label_data_text.split(\"\\n\").forEach((current_label) => {\n      var current_label_info = current_label.split(\" \");\n      //check that the label is a person\n      if (current_label_info[0] === \"0\"){\n        //add the x/y/w/h to the list\n        label_array.push(current_label_info.slice(1, 5).map(x=>parseFloat(x)));\n        label_centroids_x.push(parseFloat(current_label_info[1]));\n        label_centroids_y.push(parseFloat(current_label_info[2]));\n      }\n    });\n    //loop through the people in the information list, and for each of them, pick out their corresponding label\n    //for each row grab however many labels needed starting from the top\n    //then grab labels from that set ordered by position from the left\n    var label_jsx_list = [];\n\n    pictureData['names'].forEach( (name_row, row_index) =>{\n\n      //make a list of the labels starting from the top\n      let cur_label_array = [];\n      let cur_label_centroids_x = [];\n      for (let i = 0; i < name_row.length; i++){\n        if (label_array.length === 0){\n          continue;\n        }\n        let cur_label_index = argMin(label_centroids_y);\n        //add to cur_label_array\n        cur_label_array.push(label_array[cur_label_index]);\n        cur_label_centroids_x.push(label_centroids_x[cur_label_index]);\n        //remove from the other arrays\n        label_array.splice(cur_label_index, 1);\n        label_centroids_x.splice(cur_label_index, 1);\n        label_centroids_y.splice(cur_label_index, 1);\n      }\n\n      //pull out the people starting from the left\n      name_row.forEach( (name, column_index) => {\n        if (cur_label_array.length === 0){\n          return;\n        }\n        let cur_label_index = argMin(cur_label_centroids_x);\n        //grab x/y/w/h\n        let cur_label = cur_label_array[cur_label_index];\n        //remove from the arrays\n        cur_label_array.splice(cur_label_index, 1);\n        cur_label_centroids_x.splice(cur_label_index, 1);\n\n        let style = {\n          position: \"absolute\",\n          background: \"rgba(255, 255, 255, 0.4)\",\n          border: \"none\",\n          opacity: \"0\",\n          color: \"black\", textDecoration: \"none\",\n          display: \"flex\",flexDirection: \"row\",justifyContent: \"center\",alignItems: \"center\",textAlign: \"center\",\n          left: ((cur_label[0] - cur_label[2] / 2)*50).toFixed(0) + \"%\",\n          top: ((cur_label[1] - cur_label[3] / 2)*100).toFixed(0) + \"%\",\n          width: (cur_label[2]*50).toFixed(0) + \"%\",\n          height: (cur_label[3]*100).toFixed(0) + \"%\",\n        };\n\n        label_jsx_list.push(\n          // <button onMouseOver={labelMouseOver} onMouseOut={labelMouseOut} key={\"label_\" + name} style={style}\n          // onClick={\"location.href='\" + process.env.PUBLIC_URL + '#/person?id=' + pictureData['people'][row_index][column_index]+\"'\"}>\n          //   {name}\n          // </button>\n          <Link onMouseOver={labelMouseOver} onMouseOut={labelMouseOut} key={\"label_\" + column_index.toString() + row_index.toString()} \n          style={style} \n          to={{ pathname: '/person', search: \"id=\" + pictureData['people'][row_index][column_index] }} className=\"btn btn-primary\">\n            {name}\n          </Link>\n        );\n\n      });\n    });\n    return label_jsx_list;\n}\n\nfunction argMin(array) {\n  return array.map((x, i) => [x, i]).reduce((r, a) => (a[0] < r[0] ? a : r))[1];\n}\n\nfunction labelMouseOver(event) {\n  event.target.style.opacity = \"1\";\n}\nfunction labelMouseOut(event){\n  event.target.style.opacity = \"0\";\n}\n\n//main function\nexport default function Picture() {\n  const [labels, setLabels] = useState();\n  const [searchParams] = useSearchParams();\n  var image_name = searchParams.get('name');\n\n  //grab the image and labels\n  var image_loc = process.env.PUBLIC_URL + '/pictures/' + image_name + \".png\";\n  var image_labels_loc = process.env.PUBLIC_URL + '/pictures/labels/' + image_name + \".txt\";\n\n  //go through the json data and pull out the relevant info\n  var information_list = [];\n  var picture_data = {};\n  for (var i = 0; i < pictureJsonData.length; i++) {\n    if (pictureJsonData[i]['filename'] === image_name){\n        //found the right image data\n        picture_data = pictureJsonData[i];\n        information_list = formatPictureInformation(picture_data);\n\n    }\n  }\n\n  //add the labels\n  useMemo(async () => {\n    let response = await formatPictureLabels(image_labels_loc, picture_data);\n    setLabels(response)\n  }, [image_labels_loc, picture_data])\n\n  \n  let style = {\n    position: \"relative\"\n  };\n  return (\n    <div>\n    <style>{`\n      table, th, td {\n        border: 1px solid black;\n        border-collapse: collapse;\n        padding: 5px;\n      }\n    `}</style>\n      <div key=\"image\" style={style}>\n        <img src={image_loc} width=\"50%\" alt=\"Not found\" />\n        {labels}\n      </div>\n      <table>\n        <thead>\n        </thead>\n        <tbody>\n        {information_list.map((information_row, index) => (\n            <tr key={index}>\n                <td>{information_row[0]}</td>\n                <td>{information_row[1]}</td>\n            </tr>\n        ))}\n        </tbody>\n      </table>\n    </div>\n  );\n}","import React from \"react\";\nimport orderedTreeJsonData from '../src/json/family_tree_ordered.json'\nimport { Link } from 'react-router-dom';\n\n//take in a person's ID, output a list of jsx elements by category\n//e.g. [['father', <a href=\"link\">Dad</a>], ['spouses', <><a>spouse1</a>, <a>spouse2</a></>] ]\nexport function personRelativesList(person_id)\n{\n    var output_list = [];\n\n    //parents\n    ['Mother', 'Father'].forEach( element =>{\n        var cur_id = orderedTreeJsonData[person_id][\"rels\"][element.toLowerCase()];\n        if (cur_id)\n        {\n            var parent_link = \n                <span key={\"parent \" + cur_id}>\n                    <Link to={{ pathname: '/person', search: \"id=\" + cur_id }}>\n                        {nameFromId(cur_id)}\n                    </Link>\n                </span>;\n            output_list.push([element, parent_link]);\n        }\n    });\n\n    //spouses and children\n    ['Spouses', 'Children'].forEach( element =>{\n        var cur_ids = orderedTreeJsonData[person_id][\"rels\"][element.toLowerCase()];\n        if (cur_ids)\n        {\n            var spouses_list = \n                <div key={person_id}>\n                    {cur_ids.map( ( current_id, index )=>\n                    <span key={person_id + current_id}>\n                        <Link to={{ pathname: '/person', search: \"id=\" + current_id }}>\n                            {nameFromId(current_id)}\n                        </Link>\n                        {index + 1 < cur_ids.length ? \", \" : \"\"}\n                    </span>\n                    )}\n                </div>;\n            output_list.push([element, spouses_list]);\n        }\n    });\n    \n\n    return output_list;\n}\n\nfunction nameFromId(person_id){\n    var name = `${orderedTreeJsonData[person_id]['data']['first name'] || \"?\"} ${orderedTreeJsonData[person_id]['data']['last name'] || \"?\"}`;\n    return name;\n}\n","import React, { useMemo } from \"react\";\nimport { useTable } from \"react-table\";\nimport treeJsonData from '../src/json/family_tree.json'\nimport '../src/person_utils'\n\nfunction processData(jsonData) {\n  const result = Object.keys(jsonData).map((key) => { \n    return jsonData[key];\n  });\n  return result;\n}\n\nconst italic_style = {\n  fontStyle: 'italic'\n};\n\nexport default function People() {\n    const columns = useMemo(\n        () => [\n          {\n            Header: \"Avatar\",\n            accessor: d => <img src={\n                              process.env.PUBLIC_URL + '/pictures/thumbnails/' + d['data']['avatar'] + \".png\"\n                              } width=\"100px\" alt=\"\" />\n          },\n          {\n            Header: \"Name\",\n            accessor: d => <a href = {process.env.PUBLIC_URL + '#/person?id=' + d.id}>\n              {(d[\"data\"][\"first name\"] || \"?\") + \" \"}\n              {d[\"data\"][\"nickname\"] ? '\"' + d[\"data\"][\"nickname\"] + '\" ' : \"\"}\n              {d[\"data\"][\"last name\"] || \"?\"}\n              <span style={italic_style}>{d[\"data\"][\"nee\"] ? \" (nee \" + d[\"data\"][\"nee\"] + \")\" : \"\"}</span>\n            </a>\n          },\n          {\n            Header: \"Birthday\",\n            accessor: d => d['data']['birthday']\n          },\n          {\n            Header: \"Birthplace\",\n            accessor: d => d['data']['birthplace']\n          },\n          {\n            Header: \"Deathplace\",\n            accessor: d => d['data']['deathplace']\n          },\n          {\n            Header: \"Gender\",\n            accessor: d => d['data']['gender']\n          },\n          {\n            Header: \"Additional Information\",\n            accessor: d => d['data']['other info']\n          },\n        ],\n        []\n      );\n\n\n      const [search, setSearch] = React.useState('');\n\n      const handleSearch = (event) => {\n        setSearch(event.target.value);\n      };\n\n      const processedTreeJsonData = processData(treeJsonData);\n      \n      const data = React.useMemo(\n        () =>\n          processedTreeJsonData.filter((person) => {\n            return ((person['data']['first name'] + \" \" + person['data']['last name']).toLowerCase().includes(search.toLowerCase()) ||\n                    (person['data']['first name'] + \" \" + person['data']['nee']).toLowerCase().includes(search.toLowerCase()) ||\n                    (person['data']['nickname'] + \" \" + person['data']['last name']).toLowerCase().includes(search.toLowerCase()) ||\n                    (person['data']['nickname'] + \" \" + person['data']['nee']).toLowerCase().includes(search.toLowerCase())\n                    );\n          }),\n        [search, processedTreeJsonData]\n      );\n    \n\n      const {\n        getTableProps, // table props from react-table\n        getTableBodyProps, // table body props from react-table\n        headerGroups, // headerGroups, if your table has groupings\n        rows, // rows for the table based on the data passed\n        prepareRow // Prepare the row (this function needs to be called for each row before getting the row props)\n      } = useTable({\n        columns,\n        data\n      });\n\n    \n      return (\n        <>\n        <style>{`\n          table, th, td {\n            border: 1px solid black;\n            border-collapse: collapse;\n            padding: 5px;\n          }\n        `}</style>\n\n          <label style={{margin: \"20px 0px 20px 0px\", display: \"inline-block\"}} htmlFor=\"search\">\n            Search People:{' '}\n            <input id=\"search\" type=\"text\" onChange={handleSearch} />\n          </label>\n          <table {...getTableProps()}>\n            <thead>\n              {headerGroups.map(headerGroup => (\n                <tr {...headerGroup.getHeaderGroupProps()}>\n                  {headerGroup.headers.map(column => (\n                    <th {...column.getHeaderProps()}>{column.render(\"Header\")}</th>\n                  ))}\n                </tr>\n              ))}\n            </thead>\n            <tbody {...getTableBodyProps()}>\n              {rows.map((row, i) => {\n                prepareRow(row);\n                return (\n                  <tr {...row.getRowProps()}>\n                    {row.cells.map(cell => {\n                      return <td {...cell.getCellProps()}>{cell.render(\"Cell\")}</td>;\n                    })}\n                  </tr>\n                );\n              })}\n            </tbody>\n          </table>\n        </>\n      );\n};","import React from \"react\";\nimport treeJsonData from '../src/json/family_tree.json'\nimport pictureJsonData from '../src/json/picture_index.json'\nimport '../src/person_utils'\nimport { personRelativesList } from \"../src/person_utils\";\nimport { useSearchParams, Link } from 'react-router-dom';\n\n//take in json object of person data, output array of [[category name, string information], ...] for each applicable category\nfunction formatPersonInformation(data){\n  const italic_style = {\n    fontStyle: 'italic'\n  };\n  \n  var information_list = [];\n\n  //Name info\n  var name = \n  <>\n    {(data[\"data\"][\"first name\"] || \"?\") + \" \"}\n    {data[\"data\"][\"nickname\"] ? '\"' + data[\"data\"][\"nickname\"] + '\" ' : \"\"}\n    {data[\"data\"][\"last name\"] || \"?\"}\n    <span style={italic_style}>{data[\"data\"][\"nee\"] ? \" (nee \" + data[\"data\"][\"nee\"] + \")\" : \"\"}</span>\n  </>;\n  information_list.push([\"Name\", name]);\n\n  var personal_data_list = [\"Birthday\", \"Birthplace\", \"Deathplace\", \"Other info\", \"Gender\"];\n\n  personal_data_list.forEach(element => {\n    if (data[\"data\"][element.toLowerCase()]){\n      information_list.push([element, data[\"data\"][element.toLowerCase()]]);\n    }\n  });\n\n  var relatives_list = personRelativesList(data['id']);\n  information_list = information_list.concat(relatives_list);\n\n  return information_list;\n}\n\nfunction getPersonPictures(person_id){\n  var pictures_jsx = [];\n  pictureJsonData.forEach( pictureJson => {\n    if (pictureJson['people'].some(row => row.includes(person_id))){\n      var image_loc = process.env.PUBLIC_URL + '/pictures/' + pictureJson['filename'] + \".png\";\n\n      pictures_jsx.push(\n        <Link key={\"pic_\" + pictureJson['filename']} \n          to={{ pathname: '/picture', search: \"name=\" + pictureJson['filename'] }}>\n            <img src={image_loc} width=\"150px\" alt=\"Not found\" />\n        </Link>\n      );\n    }\n  });\n\n  return pictures_jsx;\n}\n\nexport default function Person() {\n  const [searchParams] = useSearchParams();\n  var person_id = searchParams.get('id');\n\n  //format the person's information\n  var information_list = [];\n  var avatar_loc = \"\";\n  for (var i = 0; i < treeJsonData.length; i++) {\n    if (treeJsonData[i]['id'] === person_id){\n        //found the right image data\n        information_list = formatPersonInformation(treeJsonData[i]);\n\n        //get the avatar pic\n        avatar_loc = process.env.PUBLIC_URL + '/pictures/thumbnails/' + treeJsonData[i]['data']['avatar'] + \".png\";\n    }\n  }\n  if (information_list.length === 0){\n    return <div>Person was not found</div>\n  }\n\n  //get a list of all pictures the person is in\n  var pictures_jsx = getPersonPictures(person_id);\n\n  return (\n    <div>\n    <style>{`\n      table, th, td {\n        border: 1px solid black;\n        border-collapse: collapse;\n        padding: 5px;\n      }\n    `}</style>\n    <img src={avatar_loc} width=\"30%\" alt=\"Avatar not found\" />\n    <table>\n      <thead>\n      </thead>\n      <tbody>\n      {information_list.map((information_row, index) => (\n          <tr key={index}>\n              <td>{information_row[0]}</td>\n              <td>{information_row[1]}</td>\n          </tr>\n      ))}\n      </tbody>\n    </table>\n    <br/><a href={process.env.PUBLIC_URL + \"#/family-tree?id=\" + person_id}>Link to position on family tree</a><br/>\n    <br/>Pictures:<br/>\n    {pictures_jsx}\n    </div>\n  );\n}","import React, { useState, useEffect } from 'react';\nimport Navbar from './components/Navbar';\nimport { HashRouter as Router, Routes, Route}\n    from 'react-router-dom';\nimport Login from './pages/login';\nimport FamilyTree from './pages/familyTree';\nimport Pictures from './pages/pictures';\nimport Picture from './pages/picture';\nimport People from './pages/people';\nimport Person from './pages/person';\n  \nfunction App() {\n    const [loginToken, setLoginToken] = useState(localStorage.getItem(\"auth\"));\n\n    const authstore = localStorage.getItem(\"auth\");\n\n    useEffect(() => {\n        localStorage.setItem('auth', loginToken)\n    }, [loginToken]);\n\n    if(!authstore) {\n        return (\n            <>\n                <Login setLoginToken={setLoginToken} />\n            </>\n        );\n    }\n\n    return (\n        <Router>\n        <Navbar />\n        <Routes>\n            <Route path='/family-tree' element={<FamilyTree />} />\n            <Route path='/pictures' element={<Pictures/>} />\n            <Route path='/picture' element={<Picture/>} />\n            <Route path='/people' element={<People/>} />\n            <Route path='/person' element={<Person/>} />\n        </Routes>\n        </Router>\n    );\n}\n  \nexport default App;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n  \nReactDOM.render(\n<React.StrictMode>\n      <App />\n</React.StrictMode>,\ndocument.getElementById('root')\n);"],"sourceRoot":""}